@{
    // View
    View = this;

    // Check action result
    if (printCv2.ActionResult is EmptyResult) { // Terminate page
        return;
    }

    // Layout
    if (!printCv2.UseLayout) // UseLayout = false // DN
        Layout = "";
    else
        Layout = "_Layout";

    // Local variables (Temp data)
    #pragma warning disable 168
    string? sqlWrk, filterWrk, whereWrk, curVal, dispVal;
    List<Dictionary<string, object>>? rswrk;
    string[]? arWrk;
    List<object?>? listWrk;
    object? guidWrk;
    Func<string>? lookupFilter;
    #pragma warning restore 168
}
@printCv2.ShowMessages()
@* START_CUSTOM_TEMPLATE *@
@{
    string crewId = HttpContext.Request.Query["crewid"].ToString();

    string appraisalQuery = "SELECT * FROM vw_VitaeCrewAppraisalData WHERE CrewId = '" + crewId + "'";
    string bankQuery = "SELECT * FROM vw_VitaeCrewBankData WHERE CrewId = '" + crewId + "'";
    string compliantCertificateCourseQuery = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + crewId + "'";
    string educationQuery = "SELECT * FROM vw_VitaeCrewEducationData WHERE CrewId = '" + crewId + "'";
    string generalQuery = "SELECT * FROM vw_VitaeCrewGeneralData WHERE CrewId ='" + crewId + "'";
    string idDocumentVisaQuery = "SELECT * FROM vw_VitaeCrewIdDocumentVisaData WHERE CrewId = '" + crewId + "'";
    string medicalCertificateQuery = "SELECT * FROM vw_VitaeCrewMedicalCertificateData WHERE CrewId = '" + crewId + "'";
    string medicalHistoryQuery = "SELECT * FROM vw_VitaeCrewMedicalHistoryData WHERE CrewId ='" + crewId + "'";
    string nomineeFamilyQuery = "SELECT * FROM vw_VitaeCrewNomineeFamilyData WHERE CrewId ='" + crewId + "'";
    string personalQuery = "SELECT * FROM vw_VitaeCrewPersonalData WHERE CrewId = '" + crewId + "'";
    string seaExperienceQuery = "SELECT * FROM vw_VitaeCrewSeaExperienceData WHERE CrewId = '" + crewId + "'";

    var appraisalData = ExecuteRows(appraisalQuery);
    var bankData = ExecuteRows(bankQuery);
    var compliantCertificateCourseData = ExecuteRows(compliantCertificateCourseQuery);
    var educationData = ExecuteRows(educationQuery);
    var generalData = ExecuteRows(generalQuery);
    var idDocumentVisaData = ExecuteRows(idDocumentVisaQuery);
    var medicalCertificateData = ExecuteRows(medicalCertificateQuery);
    var medicalHistoryData = ExecuteRows(medicalHistoryQuery);
    var nomineeFamilyData = ExecuteRows(nomineeFamilyQuery);
    var personalData = ExecuteRows(personalQuery);
    var seaExperienceData = ExecuteRows(seaExperienceQuery);

    if (appraisalData.Any() && bankData.Any() && compliantCertificateCourseData.Any() && educationData.Any() && generalData.Any() && idDocumentVisaData.Any() && medicalCertificateData.Any() && medicalHistoryData.Any() && nomineeFamilyData.Any() && personalData.Any() && seaExperienceData.Any())
    {
        <div class="content conten-wrapper" id="560 - Employment Application Form_v4_29830" align="center" style="background-color:#ffffff;" x:publishsource="Excel">
            <div class="page-header" style="align-items: center;">
                <div class="row col-sm-10">
                    <div class="col-sm-3" >
                        <img src="https://pertamina-pis.com/images/Logo_Pertamina_PIS.svg" alt="PIS_LOGO" style="width: 100%; height: max-height">
                    </div>
                    <div class="col-sm-6">
                        <h6 style="font-weight: bold;">PT PERTAMINA INTERNATIONAL SHIPPING</h6>
                        <h6 style="font-weight: bold;">CURRICULUM VITAE</h6>
                    </div>
                    <div class="col-sm-3">
                        <p>Form 560</p>
                    </div>
                </div>
            </div>

            <table border="0" cellpadding="0" cellspacing="0" width="750" class="xl6829830" style="border-collapse: collapse; table-layout: fixed; width: 554pt">
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 512; width: 11pt" />
                <col class="xl6829830" width="17" style="mso-width-source: userset; mso-width-alt: 597; width: 13pt" />
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 512; width: 11pt" />
                <col class="xl6829830" width="19" style="mso-width-source: userset; mso-width-alt: 682; width: 14pt" />
                <col class="xl6829830" width="14" span="2" style="mso-width-source: userset; mso-width-alt: 483; width: 10pt" />
                <col class="xl6829830" width="11" span="2" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="19" style="mso-width-source: userset; mso-width-alt: 682; width: 14pt" />
                <col class="xl6829830" width="11" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="15" style="mso-width-source: userset; mso-width-alt: 540; width: 11pt" />
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 512; width: 11pt" />
                <col class="xl6829830" width="11" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="21" style="mso-width-source: userset; mso-width-alt: 739; width: 16pt" />
                <col class="xl6829830" width="18" style="mso-width-source: userset; mso-width-alt: 625; width: 13pt" />
                <col class="xl6829830" width="11" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 483; width: 10pt" />
                <col class="xl6829830" width="11" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="18" style="mso-width-source: userset; mso-width-alt: 654; width: 14pt" />
                <col class="xl6829830" width="11" span="2" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="2" style="mso-width-source: userset; mso-width-alt: 85; width: 2pt" />
                <col class="xl6829830" width="1" style="mso-width-source: userset; mso-width-alt: 28; width: 1pt" />
                <col class="xl6829830" width="11" span="8" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="15" style="mso-width-source: userset; mso-width-alt: 540; width: 11pt" />
                <col class="xl6829830" width="11" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="18" style="mso-width-source: userset; mso-width-alt: 625; width: 13pt" />
                <col class="xl6829830" width="11" span="2" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 483; width: 10pt" />
                <col class="xl6829830" width="11" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="18" style="mso-width-source: userset; mso-width-alt: 625; width: 13pt" />
                <col class="xl6829830" width="1" style="mso-width-source: userset; mso-width-alt: 28; width: 1pt" />
                <col class="xl6829830" width="17" style="mso-width-source: userset; mso-width-alt: 597; width: 13pt" />
                <col class="xl6829830" width="10" style="mso-width-source: userset; mso-width-alt: 341; width: 7pt" />
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 512; width: 11pt" />
                <col class="xl6829830" width="17" style="mso-width-source: userset; mso-width-alt: 597; width: 13pt" />
                <col class="xl6829830" width="15" style="mso-width-source: userset; mso-width-alt: 540; width: 11pt" />
                <col class="xl6829830" width="19" style="mso-width-source: userset; mso-width-alt: 682; width: 14pt" />
                <col class="xl6829830" width="15" style="mso-width-source: userset; mso-width-alt: 540; width: 11pt" />
                <col class="xl6829830" width="11" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 512; width: 11pt" />
                <col class="xl6829830" width="11" span="2" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 483; width: 10pt" />
                <col class="xl6829830" width="11" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 483; width: 10pt" />
                <col class="xl6829830" width="11" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="14" style="mso-width-source: userset; mso-width-alt: 483; width: 10pt" />
                <col class="xl6829830" width="11" span="2" style="mso-width-source: userset; mso-width-alt: 398; width: 8pt" />
                <col class="xl6829830" width="10" style="mso-width-source: userset; mso-width-alt: 369; width: 8pt" />

                <thead>
                    <tr>
                        <td class="headerGroup">
                            <div class="header-block"></div>
                        </td>
                    </tr>
                </thead>

                <tfoot>
                    <tr>
                        <td class="footerGroup">
                            <div class="footer-block"></div>
                        </td>
                    </tr>
                </tfoot>

                <tbody>
                    <tr>
                        <td>
                            <div class="page-container">
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" width="750" style="height: 12pt; width: 554pt"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="43" rowspan="2" height="31" class="xl6829830" style="height: 23.4pt"></td>
                                    <td colspan="15" class="xl9429830" style="border-right: 0.5pt solid black">
                                        <script>
                                            var IndividualSeafarerId = '@personalData[0]["IndividualCodeNumber"]';
                                            for (var i = 0; i < IndividualSeafarerId.length; i++) {
                                                document.write(IndividualSeafarerId.charAt(i) + '<span style="display: inline-block; height: 100%; border-right: 0.5px solid black; margin-right: 5px; border-left: 0.5px solid black;"></span>');
                                            }
                                        </script>
                                    </td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="15" height="16" class="xl11529830" style="height: 12pt">Individual's Seafarer ID</td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="border-bottom: 0.5pt solid black; height: 12pt">1. Personal Data</td>
                                </tr>
                                <tr height="15" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="13" height="15" class="xl8729830" style="border-right: none; height: 12pt; padding-left: 5px;">Full Name</td>
                                    <td colspan="15" class="xl8729830" style="border-left: none; border-right: none; background-color: #fff; padding-left: 5px;">@*Middle Name (s)*@</td>
                                    <td colspan="15" class="xl8729830" style="border-left: none; border-right: none; background-color: #fff;padding-left: 5px;">@*Last Name / Surname*@</td>
                                    <td colspan="5" rowspan="2" class="xl10629830" width="77" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 57pt; padding-left: 5px; text-align: left">Status:</td>
                                    <td colspan="11" rowspan="2" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; padding-left: 5px;">@personalData[0]["Status"]</td>
                                </tr>
                                <tr height="15" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="13" rowspan="3" height="45" class="xl9029830" style="border-right: none; border-bottom: 0.5pt solid black; height: 34.2pt; padding-left: 5px; text-align: left">@personalData[0]["FullName"]</td>
                                    <td colspan="15" rowspan="3" class="xl9029830" style="border-left: none; border-right: none; border-bottom: 0.5pt solid black; background-color: #fff;">@*@personalData[0]["MiddleName"]*@</td>
                                    <td colspan="15" rowspan="3" class="xl9029830" style="border-left: none; border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; background-color: #fff;">@*@personalData[0]["LastName"]*@</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="5" rowspan="2" height="30" class="xl8829830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 22.8pt; padding-left: 5px; text-align: left">Reason:</td>
                                    <td colspan="11" rowspan="2" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; padding-left: 5px; text-align: left">@personalData[0]["Reason"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="13" height="16" class="xl12229830" style="height: 12pt; padding-left: 5px; text-align: left">Nationality</td>
                                    <td colspan="10" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Country Of Origin</td>
                                    <td colspan="9" class="xl10129830" style="border-left: none">Date of Birth</td>
                                    <td colspan="2" class="xl10129830" style="border-left: none">Age</td>
                                    <td colspan="9" class="xl10129830" style="border-left: none">Place of Birth</td>
                                    <td colspan="3" class="xl6829830" style="border-right: 1pt solid black"></td>
                                    <td colspan="8" rowspan="9" class="xl14729830" width="101" style="border-right: 1pt solid black; border-bottom: 1pt solid black; width: 74pt">
                                        @{
                                            string requiredPhotoUrl = $"{AppPath()}uploads/{personalData[0]["IndividualCodeNumber"]}/{personalData[0]["RequiredPhoto"]}";
                                        }
                                        <img src="@Html.Raw(requiredPhotoUrl)" alt="crew-photo" style="max-width:100%; max-height:100%" />
                                    </td>
                                    <td colspan="5" class="xl14629830" style="border-left: none"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="13" rowspan="3" height="45" class="xl14329830" style="border-bottom: 0.5pt solid black; height: 34.2pt">@personalData[0]["Nationality"]</td>
                                    <td colspan="10" rowspan="3" class="xl7829830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black">@personalData[0]["CountryName"]</td>
                                    <td colspan="3" rowspan="3" class="xl6529830"></td> @* Placeholder for MM *@
                                    <td colspan="3" rowspan="3" class="xl6529830"></td> @* Placeholder for DD *@
                                    <td colspan="3" rowspan="3" class="xl6529830"></td> @* Placeholder for YYYY *@
                                    <td colspan="2" rowspan="3" class="xl6529830">@personalData[0]["Age"]</td>
                                    <td colspan="9" rowspan="3" class="xl6529830">@personalData[0]["CityOfBirth"]</td>
                                    <td colspan="3" class="xl6829830" style="border-right: 1pt solid black"></td>
                                    <td colspan="5" class="xl14629830" style="border-left: none"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="3" height="15" class="xl6829830" style="border-right: 1pt solid black; height: 12pt"></td>
                                    <td colspan="5" class="xl14629830" style="border-left: none"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="3" height="15" class="xl6829830" style="border-right: 1pt solid black; height: 12pt"></td>
                                    <td colspan="5" class="xl14629830" style="border-left: none"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="46" height="15" class="xl6829830" style="border-right: 1pt solid black; height: 12pt"></td>
                                    <td colspan="5" class="xl14629830" style="border-left: none"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="13" height="16" class="xl8729830" style="border-right: 0.5pt solid black; height: 12pt; padding-left: 5px; text-align: left">Religion</td>
                                    <td colspan="8" class="xl8729830" style="border-right: 0.5pt solid black; border-left: none; padding-left: 5px; text-align: left">Marital Status</td>
                                    <td colspan="14" class="xl8729830" style="border-right: 0.5pt solid black; border-left: none; padding-left: 5px; text-align: left">Gender</td>
                                    <td colspan="11" class="xl9029830" style="border-right: 1pt solid black; border-left: none"></td>
                                    <td colspan="5" class="xl14629830" style="border-left: none"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="13" rowspan="2" height="30" class="xl9029830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 22.8pt; padding-left: 5px; text-align: left">@personalData[0]["ReligionName"]</td>
                                    <td colspan="8" rowspan="2" class="xl9029830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; padding-left: 5px; text-align: left">@personalData[0]["MaritalStatus"]</td>
                                    <td colspan="14" rowspan="2" class="xl9029830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; padding-left: 5px; text-align: left">
                                        @{
                                            var gender = @personalData[0]["Gender"].ToString();

                                            var genderText = gender == "M" ? "Male" : (gender == "F" ? "Female" : "");
                                        }
                                        @genderText
                                    </td>

                                    <td colspan="11" class="xl9029830" style="border-right: 1pt solid black; border-left: none"></td>
                                    <td colspan="5" class="xl14629830" style="border-left: none"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="11" height="15" class="xl9029830" style="border-right: 1pt solid black; height: 12pt; border-left: none"></td>
                                    <td colspan="5" class="xl14629830" style="border-left: none"></td>
                                </tr>
                                <tr height="17" style="height: 12.6pt">
                                    <td colspan="46" height="17" class="xl12129830" style="border-right: 1pt solid black; height: 12.6pt"></td>
                                    <td colspan="5" class="xl14629830" style="border-left: none"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="8" height="16" class="xl7529830" style="height: 12pt">Total Sea Service:</td>
                                    <td colspan="51" class="xl11329830" style="border-right: 0.5pt solid black; padding-left: 5px; text-align: left">
                                        @{
                                            var formattedExperience = string.Empty;
                                            
                                            if (seaExperienceData.Count > 0 && seaExperienceData[0]["CrewExperienceTotalSeaExperience"] != null)
                                            {
                                                var totalSeaExperience = (int)seaExperienceData[0]["CrewExperienceTotalSeaExperience"];
                                                
                                                var years = totalSeaExperience / 365;
                                                var months = (totalSeaExperience % 365) / 30;
                                                var days = (totalSeaExperience % 365) % 30;

                                                formattedExperience = $"{years} Years {months} Months {days} Days";
                                            }
                                        }
                                        @formattedExperience
                                    </td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="19" height="16" class="xl7429830" style="height: 12pt">Vessel Type</td>
                                    <td colspan="21" class="xl7429830" style="border-left: none">Rank</td>
                                    <td colspan="19" class="xl7429830" style="border-left: none">Experience</td>
                                </tr>
                                @{
                                    var uniqueList = seaExperienceData
                                        .DistinctBy(list => new
                                        {
                                            CrewExperienceVesselType = (string)list["CrewExperienceVesselType"],
                                            CrewExperienceRank = (string)list["CrewExperienceRank"],
                                            CrewExperienceDuration = list["CrewExperienceDuration"] != null ? (int)list["CrewExperienceDuration"] : 0
                                        })
                                        .ToList();
                                }
                                @foreach (var list in uniqueList)
                                {
                                    <tr height="15" style="height: 12pt">
                                        <td colspan="19" height="15" class="xl7129830" style="height: 12pt; padding-left: 5px; text-align: left">@((string)list["CrewExperienceVesselType"] ?? "")</td>
                                        <td colspan="21" class="xl7129830" style="border-left: none; padding-left: 5px; text-align: left">@((string)list["CrewExperienceRank"] ?? "")</td>
                                        <td colspan="19" class="xl7129830" style="border-left: none; padding-left: 5px; text-align: left">
                                            @{
                                                var rankExperience = list.TryGetValue("CrewExperienceDuration", out var duration) && duration != null ? (int)duration : 0;
                                                var rankYears = rankExperience / 365;
                                                var rankMonths = (rankExperience % 365) / 30;
                                                var rankDays = (rankExperience % 365) % 30;
                                                var formattedRankExperience = $"{rankYears} Years {rankMonths} Months {rankDays} Days";
                                            }
                                            @formattedRankExperience
                                        </td>
                                    </tr>
                                }
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="17" height="16" class="xl8729830" style="border-right: 0.5pt solid black; height: 12pt; padding-left: 5px; text-align: left">Rank Applied For</td>
                                    <td colspan="20" class="xl15629830" style="border-right: 0.5pt solid black; padding-left: 5px; text-align: left">Willing to accept lower rank?</td>
                                    <td colspan="12" class="xl12129830" style="border-top: 0.5pt solid black; padding-left: 5px; text-align: left">Available From</td>
                                    <td colspan="3" rowspan="3" class="xl7829830" id="availableFromDD" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black"></td> @* Placeholder for DD *@
                                    <td colspan="3" rowspan="3" class="xl7829830" id="availableFromMM" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black"></td> @* Placeholder for MM *@
                                    <td colspan="4" rowspan="3" class="xl7829830" id="availableFromYYYY" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black"></td> @* Placeholder for YYYY *@
                                </tr>
                                <tr height="18" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="17" rowspan="4" height="66" class="xl9029830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 49.2pt; padding-left: 5px; text-align: left">@personalData[0]["RankAppliedForName"]</td>
                                    <td colspan="18" class="xl9729830" style="border-right: 0.5pt solid black">Yes</td>
                                    @if(personalData[0]["WillAcceptLowRank"].ToString().Equals("True"))
                                    {
                                        <td class="xl7129830" style="border-left: none; padding-left: 0px">
                                            <span style="color: black; display: inline-block; line-height: 1">&#10003;</span>
                                        </td>
                                    } else {
                                        <td class="xl7129830" style="border-left: solid 1px black;"></td>
                                    }
                                    <td class="xl7029830"></td>
                                    <td colspan="12" rowspan="4" class="xl6829830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="20" height="15" class="xl9929830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                </tr>
                                <tr height="18" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="18" height="18" class="xl9729830" style="border-right: 0.5pt solid black; height: 12pt">No</td>
                                    @if(personalData[0]["WillAcceptLowRank"].ToString().Equals("True"))
                                    {
                                        <td class="xl7129830" style="border-left: solid 1px black;"></td>
                                    } else {
                                        <td class="xl7129830" style="border-left: none; padding-left: 0px">
                                            <span style="color: black; display: inline-block; line-height: 1">&#10003;</span>
                                        </td>
                                    }
                                    
                                    <td class="xl7029830"></td>
                                    <td colspan="3" rowspan="2" class="xl7829830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black">DD</td>
                                    <td colspan="3" rowspan="2" class="xl7829830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black">MM</td>
                                    <td colspan="4" rowspan="2" class="xl7829830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black">YYYY</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="20" height="15" class="xl9229830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl9229830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="29" height="16" class="xl15829830" style="border-right: 0.5pt solid black; height: 12pt; padding-left: 5px; text-align: left">Primary / Permanent Address:</td>
                                    <td colspan="17" class="xl8729830" style="border-left: none; padding-left: 5px; text-align: left">Alternative / Temporary Address:</td>
                                    <td colspan="3" class="xl11529830" style="border-right: 0.5pt solid black; padding-left: 5px; text-align: left">Until:</td>
                                    <td colspan="3" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td> @* Placeholder for DD *@
                                    <td colspan="3" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td> @* Placeholder for MM *@
                                    <td colspan="3" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td> @* Placeholder for YYYY *@
                                    <td class="xl6929830" style="border-top: none"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="29" rowspan="3" height="45" class="xl13829830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 34.2pt; font-weight: normal; padding-left: 5px; text-align: left">@personalData[0]["PrimaryAddressDetail"]</td>
                                    <td colspan="30" rowspan="3" class="xl9029830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; padding-left: 5px; text-align: left">@personalData[0]["AlternativeAddressDetail"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="18" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="14" height="18" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">City: @personalData[0]["PrimaryAddressCity"]</td>
                                    <td colspan="15" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word;padding-left: 5px; text-align: left">Post Code: @personalData[0]["PrimaryAddressPostCode"]</td>
                                    <td colspan="16" class="xl11229830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">City: @personalData[0]["AlternativeAddressCity"]</td>
                                    <td colspan="14" class="xl11329830" style="border-right: 0.5pt solid black; white-space: normal; word-break: break-word; border-left: 0.5pt solid black; padding-left: 5px; text-align: left">Post Code: @personalData[0]["AlternativeAddressPostCode"]</td>
                                </tr>
                                <tr height="18" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="14" height="18" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">State: @personalData[0]["PrimaryAddressState"]</td>
                                    <td colspan="15" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Country: @personalData[0]["PrimaryCountryName"]</td>
                                    <td colspan="16" class="xl11229830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">State: @personalData[0]["AlternativeAddressState"]</td>
                                    <td colspan="14" class="xl11329830" style="border-right: 0.5pt solid black; white-space: normal; word-break: break-word; border-left: 0.5pt solid black; padding-left: 5px; text-align: left">Country: @personalData[0]["AlternativeCountryName"]</td>
                                </tr>
                                <tr height="18" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="14" height="18" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Nearest Airport: @personalData[0]["PrimaryAddressNearestAirport"]</td>
                                    <td colspan="15" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Home Tel: @personalData[0]["PrimaryAddressHomeTel"]</td>
                                    <td colspan="16" class="xl11229830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Phone: @personalData[0]["AlternativeAddressPhone"]</td>
                                    <td colspan="14" class="xl11329830" style="border-right: 0.5pt solid black"></td>
                                </tr>

                                <tr height="18" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="14" height="18" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Mobile Tel: @personalData[0]["MobileNumber"]</td>
                                    <td colspan="45" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Email: @personalData[0]["Email"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="18" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Weight: @personalData[0]["Weight"] kg</td>
                                    <td colspan="20" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Height: @personalData[0]["Height"] cm</td>
                                    <td colspan="21" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">BMI Index : @personalData[0]["BMI"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="30" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Coverall Size: @personalData[0]["CoverallSize"]<span style="mso-spacerun: yes"></span></td>
                                    <td colspan="29" class="xl16129830" style="border-right: 0.5pt solid black; white-space: normal; word-break: break-word;">@*(Specify size as S,<span style="mso-spacerun: yes"> </span>M,<span style="mso-spacerun: yes"> </span>L,<span style="mso-spacerun: yes"> </span>XL, XXL, XXXL)*@</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="30" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Safety Shoes Size: @personalData[0]["SafetyShoesSize"]</td>
                                    <td colspan="29" class="xl16329830" style="border-right: 0.5pt solid black; white-space: normal; word-break: break-word;">@*(Specify size as 37, 38, 39, 40, 41, 42, 43, 44, 45)*@</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="30" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; text-align: left">Shirt Size: @personalData[0]["ShirtSize"]</td>
                                    <td colspan="29" class="xl16329830" style="border-right: 0.5pt solid black">@*(Specify size as 14; 14.5; 15; 15.5; 16; 16.5; 17; 17.5)*@</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="30" height="15" class="xl11229830" style="height: 12pt padding-left: 5px; text-align: left;">Trousers Size: @personalData[0]["TrousersSize"]</td>
                                    <td colspan="29" class="xl16329830" style="border-right: 0.5pt solid black">@*(Specify size as 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40)*@</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="height: 12pt">2. Personal ID / Documents / Visa</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="12" rowspan="2" height="30" class="xl11629830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black;">Type of Document / ID<font class="font629830"><sup>2</sup></font></td>
                                    <td colspan="9" rowspan="2" class="xl11629830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black">Country of Issue</td>
                                    <td colspan="13" rowspan="2" class="xl11629830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black">No.</td>
                                    <td colspan="10" rowspan="2" class="xl10629830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black;">Date of Issue</td>
                                    <td colspan="7" rowspan="2" class="xl11629830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black">Place of Issue</td>
                                    <td colspan="13" rowspan="2" class="xl10629830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black;">Valid Until</td>
                                </tr>
                                <tr height="15" style="height: 12pt"></tr>
                                @{
                                    var uniqueListPersonalDocument = idDocumentVisaData
                                        .Where(list =>
                                            list["DocumentType"] != null &&
                                            list["DocumentCountryOfIssue"] != null &&
                                            list["DocumentNumber"] != null &&
                                            list["DateOfIssue"] != null &&
                                            list["PlaceOfIssue"] != null &&
                                            list["DateValidUntil"] != null)
                                        .DistinctBy(list => new
                                        {
                                            DocumentType = (string)list["DocumentType"],
                                            DocumentCountryOfIssue = (string)list["DocumentCountryOfIssue"],
                                            DocumentNumber = (string)list["DocumentNumber"],
                                            DateOfIssue = (DateTime)list["DateOfIssue"],
                                            PlaceOfIssue = (string)list["PlaceOfIssue"],
                                            DateValidUntil = (DateTime)list["DateValidUntil"]
                                        })
                                        .ToList();
                                }
                                @foreach (var list in uniqueListPersonalDocument)
                                {
                                    <tr height="15" style="height: 12pt">
                                        <td colspan="12" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word;">@(list["DocumentType"] ?? "")</td>
                                        <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word;">@(list["DocumentCountryOfIssue"] ?? "")</td>
                                        <td colspan="13" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none;">@(list["DocumentNumber"] ?? "")</td>
                                        <td colspan="10" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word;">@(((DateTime)list["DateOfIssue"]).ToString("dd MMM yyyy"))</td>
                                        <td colspan="7" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word;">@(list["PlaceOfIssue"] ?? "")</td>
                                        <td colspan="13" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word;">@(((DateTime)list["DateValidUntil"]).ToString("dd MMM yyyy"))</td>
                                    </tr>
                                }
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl9729830" style="height: 12pt">GIVE TAX INFORMATION BELOW ONLY IF REQUESTED TO DO SO</td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="29" height="16" class="xl7529830" style="border-right: 0.5pt solid black; height: 12pt">National Identity Number</td>
                                    <td class="xl6829830"></td>
                                    <td colspan="29" class="xl7529830" style="border-right: 0.5pt solid black">Personal Tax</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="13" height="15" class="xl12729830" style="border-right: 0.5pt solid black; height: 12pt">Number:</td>
                                    <td colspan="16" class="xl12729830" style="border-right: 0.5pt solid black; border-left: none">Issuing Country:</td>
                                    <td class="xl6829830"></td>
                                    <td colspan="14" class="xl12729830" style="border-right: 0.5pt solid black">Number:</td>
                                    <td colspan="15" class="xl12729830" style="border-right: 0.5pt solid black; border-left: none">Issuing Country:</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="13" height="15" class="xl9129830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word;">@idDocumentVisaData[0]["NationalIdentityNumber"]</td>
                                    <td colspan="16" class="xl9129830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word;">@idDocumentVisaData[0]["NationalIdentityCountryIssue"]</td>
                                    <td class="xl6829830"></td>
                                    <td colspan="14" class="xl9129830" style="border-right: 0.5pt solid black; white-space: normal; word-break: break-word;">@idDocumentVisaData[0]["PersonalTaxNumber"]</td>
                                    <td colspan="15" class="xl9129830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word;">@idDocumentVisaData[0]["PersonalTaxCountryIssue"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="18" style="height: 12pt">
                                    <td colspan="5" height="18" class="xl16529830" style="height: 12pt"><sup>2</sup><font class="font729830">Select from:</font></td>
                                    <td colspan="5" height="18" width="66" style="height: 12pt; width: 48pt" align="left" valign="top">
                                    <table cellpadding="0" cellspacing="0">
                                        <tr>
                                            <td colspan="5" height="18" class="xl6829830" width="66" style="height: 12pt; width: 48pt"><span style="mso-spacerun: yes"></span>&#9679;Passport</td>
                                        </tr>
                                    </table>
                                    </td>
                                    <td colspan="8" height="18" width="115" style="height: 12pt; width: 85pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 2; margin-left: 6px; margin-top: 2px; width: 10px; height: 11px"><img width="10" height="11" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image002.png" v:shapes="_x0000_s15869" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="8" height="18" class="xl6829830" width="115" style="height: 12pt; width: 85pt"><span style="mso-spacerun: yes"></span>&#9679;Seamans Book</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="11" height="18" width="109" style="height: 12pt; width: 81pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 3; margin-left: 0px; margin-top: 2px; width: 11px; height: 11px"><img width="11" height="11" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image004.png" v:shapes="_x0000_s15870" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="11" height="18" class="xl6829830" width="109" style="height: 12pt; width: 81pt">&#9679;Seaman Passport</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="14" height="18" width="173" style="height: 12pt; width: 127pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 4; margin-left: 6px; margin-top: 2px; width: 10px; height: 11px"><img width="10" height="11" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image002.png" v:shapes="_x0000_s15871" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="14" height="18" class="xl6829830" width="173" style="height: 12pt; width: 127pt"><span style="mso-spacerun: yes"></span>&#9679;Seafarer's Identity Document</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="8" height="18" width="113" style="height: 12pt; width: 84pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 5; margin-left: 6px; margin-top: 2px; width: 10px; height: 11px"><img width="10" height="11" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image002.png" v:shapes="_x0000_s15872" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="8" height="18" class="xl6829830" width="113" style="height: 12pt; width: 84pt">&#9679;Registration Book</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="8" height="18" width="96" style="height: 12pt; width: 70pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 6; margin-left: 4px; margin-top: 2px; width: 11px; height: 11px"><img width="11" height="11" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image004.png" v:shapes="_x0000_s15873" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="8" height="18" class="xl6829830" width="96" style="height: 12pt; width: 70pt">&#9679;National Card</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="12" height="15" width="173" style="height: 12pt; width: 129pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 7; margin-left: 6px; margin-top: 3px; width: 10px; height: 10px"><img width="10" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image006.png" v:shapes="_x0000_s15874" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="12" height="15" class="xl6829830" width="173" style="height: 12pt; width: 129pt">&#9679;PAG-IBIG Housing Insurance</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="7" height="15" width="104" style="height: 12pt; width: 77pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 8; margin-left: 2px; margin-top: 3px; width: 10px; height: 10px"><img width="10" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image006.png" v:shapes="_x0000_s15875" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="7" height="15" class="xl6829830" width="104" style="height: 12pt; width: 77pt"><span style="mso-spacerun: yes"></span>&#9679;Driving Licence</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="12" height="15" width="113" style="height: 12pt; width: 83pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 9; margin-left: 3px; margin-top: 3px; width: 10px; height: 10px"><img width="10" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image006.png" v:shapes="_x0000_s15876" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="12" height="15" class="xl6829830" width="113" style="height: 12pt; width: 83pt"><span style="mso-spacerun: yes"></span>&#9679;Overseas EMP Cert</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="6" height="15" width="80" style="height: 12pt; width: 58pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 10; margin-left: 8px; margin-top: 3px; width: 11px; height: 10px"><img width="11" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image008.png" v:shapes="_x0000_s15877" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="6" height="15" class="xl6829830" width="80" style="height: 12pt; width: 58pt"><span style="mso-spacerun: yes"></span>&#9679;PHL Card</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="7" height="15" width="88" style="height: 12pt; width: 66pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 11; margin-left: 7px; margin-top: 1px; width: 11px; height: 11px"><img width="11" height="11" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image004.png" v:shapes="_x0000_s15878" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="7" height="15" class="xl6829830" width="88" style="height: 12pt; width: 66pt"><span style="mso-spacerun: yes"></span>&#9679;Pention Fund</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="7" height="15" width="96" style="height: 12pt; width: 71pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 12; margin-left: 2px; margin-top: 3px; width: 10px; height: 10px"><img width="10" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image006.png" v:shapes="_x0000_s15879" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="7" height="15" class="xl6829830" width="96" style="height: 12pt; width: 71pt">&#9679;Provident Fund</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="8" height="15" width="96" style="height: 12pt; width: 70pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 13; margin-left: 4px; margin-top: 3px; width: 11px; height: 10px"><img width="11" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image008.png" v:shapes="_x0000_s15880" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="8" height="15" class="xl6829830" width="96" style="height: 12pt; width: 70pt">&#9679;Provident Trust</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="12" height="15" width="173" style="height: 12pt; width: 129pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 14; margin-left: 6px; margin-top: 4px; width: 10px; height: 10px"><img width="10" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image006.png" v:shapes="_x0000_s15881" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="12" height="15" class="xl6829830" width="173" style="height: 12pt; width: 129pt">&#9679;Professional Organisation</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="3" height="15" width="50" style="height: 12pt; width: 37pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 15; margin-left: 2px; margin-top: 4px; width: 10px; height: 10px"><img width="10" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image006.png" v:shapes="_x0000_s15882" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="3" height="15" class="xl6829830" width="50" style="height: 12pt; width: 37pt">&#9679;Visa</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="44" class="xl6829830"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="height: 12pt">3. Bank Account</td>
                                </tr>
                                <tr height="18" style="height: 12pt">
                                    @*<td height="18" class="xl7229830" style="height: 12pt"><sup></sup></td>*@
                                    <td colspan="8" class="xl10129830">Bank</td>
                                    <td colspan="9" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Account Number</td>
                                    <td colspan="10" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Beneficiary</td>
                                    <td colspan="12" class="xl10129830" style="border-left: none">Currency</td>
                                    <td colspan="6" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 10px; padding-right: 10px">Is Main Acc?</td>
                                    <td colspan="6" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Attachment*</td>
                                    <td colspan="7" class="xl9029830" style="border-left: none"></td>
                                </tr>
                                @{
                                    var distinctList = bankData
                                        .Select(list => new
                                        {
                                            BankName = list["BankName"]?.ToString(),
                                            AccountNumber = list["AccountNumber"]?.ToString(),
                                            Beneficiary = list["Beneficiary"]?.ToString(),
                                            Currency = list["Currency"]?.ToString(),
                                            MainAcc = list["MainAcc"]?.ToString()
                                        })
                                        .DistinctBy(item => new
                                        {
                                            item.BankName,
                                            item.AccountNumber,
                                            item.Beneficiary,
                                            item.Currency,
                                            item.MainAcc
                                        })
                                        .ToList();

                                    foreach (var list in distinctList)
                                    {
                                        <tr height="18" style="height: 12pt">
                                            <td colspan="8" class="xl11229830" style="border-right: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.BankName ?? "")</td>
                                            <td colspan="9" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word;">@(list.AccountNumber ?? "")</td>
                                            <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.Beneficiary ?? "")</td>
                                            <td colspan="12" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word;">@(list.Currency ?? "")</td>
                                            @if (list.MainAcc != null && list.MainAcc.Equals("True"))
                                            {
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none">&check;</td>
                                            }
                                            else if (list.MainAcc != null && list.MainAcc.Equals("False"))
                                            {
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none">&cross;</td>
                                            }
                                            else
                                            {
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            }
                                            <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:5px;">
                                                <a href="#" target="_blank" style="text-decoration: underline; color: blue;">Attachment</a>
                                            </td>
                                            <td colspan="7" class="xl9029830" style="border-left: none"></td>
                                        </tr>
                                    }
                                }
                                <tr height="15" style="height: 12pt" >
                                    <td colspan="59" height="15" class="xl16629830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12429830" style="height: 12pt">4. Nominee / Next of Kin &amp; Family Details</td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="24" height="16" class="xl8729830" style="border-right: 0.5pt solid black; height: 12pt">Full Name of Nominee</td>
                                    <td colspan="10" class="xl8729830" style="border-right: 0.5pt solid black; border-left: none">Relationship</td>
                                    <td colspan="11" class="xl8729830" style="border-right: 0.5pt solid black; border-left: none">Gender</td>
                                    <td colspan="14" class="xl8729830" style="border-right: 0.5pt solid black; border-left: none">Nationality</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="24" rowspan="3" height="45" class="xl9029830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 34.2pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@nomineeFamilyData[0]["NomineeFullName"]</td>
                                    <td colspan="10" rowspan="3" class="xl9029830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@nomineeFamilyData[0]["NomineeRelationship"]</td>
                                    <td colspan="9" class="xl17229830" style="border-right: 0.5pt solid black; border-left: none">Male</td>
                                    @if(nomineeFamilyData[0]["NomineeGender"].ToString().Equals("M")) {
                                        <td class="xl6529830" style="border-left: none">
                                            <span style="color: black; display: inline-block; line-height: 1">&check;</span>
                                        </td>
                                    } else {
                                        <td class="xl6529830" style="border-left: none"></td>
                                    }
                                    <td class="xl6729830"></td>
                                    <td colspan="14" rowspan="3" class="xl9029830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@nomineeFamilyData[0]["NomineeNationality"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="9" height="15" class="xl17229830" style="border-right: 0.5pt solid black; height: 12pt; border-left: none">Female</td>
                                    @if(nomineeFamilyData[0]["NomineeGender"].ToString().Equals("F")) {
                                        <td class="xl6529830" style="border-top: none; border-left: none">
                                            <span style="color: black; display: inline-block; line-height: 1">&check;</span>
                                        </td>
                                    } else {
                                        <td class="xl6529830" style="border-left: none"></td>
                                    }
                                    <td class="xl6729830"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="11" height="15" class="xl8429830" style="border-right: 0.5pt solid black; height: 12pt; border-left: none"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" rowspan="2" height="30" class="xl17329830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 22.8pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">Address: @nomineeFamilyData[0]["NomineeAddressDetail"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="24" height="15" class="xl7129830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">City: @nomineeFamilyData[0]["NomineeAddressCity"]</td>
                                    <td colspan="21" class="xl7129830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">Post Code: @nomineeFamilyData[0]["NomineeAddressPostCode"]</td>
                                    <td colspan="14" class="xl7129830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">Country: @nomineeFamilyData[0]["NomineeCountry"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="24" height="15" class="xl7129830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">Email: @nomineeFamilyData[0]["NomineeEmail"]</td>
                                    <td colspan="21" class="xl7129830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">Tel: @nomineeFamilyData[0]["NomineeAddressHomeTel"]</td>
                                    <td colspan="14" class="xl7129830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">Mobile: @nomineeFamilyData[0]["NomineeMobileNumber"]</td>
                                </tr>
                                <tr height="18" style="height: 12pt">
                                    <td colspan="6" height="18" class="xl6829830" style="height: 12pt">1Select From:</td>
                                    <td colspan="8" height="18" width="113" style="height: 12pt; width: 84pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 17; margin-left: 4px; margin-top: 3px; width: 11px; height: 10px"><img width="11" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image008.png" v:shapes="_x0000_s15884" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="8" height="18" class="xl17929830" width="113" style="height: 12pt; width: 84pt">&#9679;Spouse</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="7" height="18" width="94" style="height: 12pt; width: 69pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 16; margin-left: 6px; margin-top: 3px; width: 10px; height: 10px"><img width="10" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image009.png" v:shapes="AutoShape_x0020_40" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="7" height="18" class="xl6829830" width="94" style="height: 12pt; width: 69pt"><span style="mso-spacerun: yes"></span>&#9679;Partner</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="10" height="18" width="91" style="height: 12pt; width: 67pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 18; margin-left: 4px; margin-top: 3px; width: 11px; height: 10px"><img width="11" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image008.png" v:shapes="_x0000_s15885" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="10" height="18" class="xl6829830" width="91" style="height: 12pt; width: 67pt">&#9679;Parent</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                    <td colspan="28" height="18" width="360" style="height: 12pt; width: 265pt" align="left" valign="top">
                                        <![if !vml]><span style="mso-ignore: vglayout; position: absolute; z-index: 19; margin-left: 3px; margin-top: 5px; width: 10px; height: 10px"><img width="10" height="10" src="560%20-%20Employment%20Application%20Form_v4_files/560%20-%20Employment%20Application%20Form_v4_29830_image009.png" v:shapes="_x0000_s15886" /></span><![endif]><span style="mso-ignore: vglayout2">
                                            <table cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td colspan="28" height="18" class="xl6829830" width="360" style="height: 12pt; width: 265pt">&#9679;Other Relative (Please Specify)</td>
                                                </tr>
                                            </table>
                                        </span>
                                    </td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12429830" style="height: 12pt"><span style="mso-spacerun: yes"> </span>Family Data:</td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="9" height="16" class="xl7529830" style="border-right: 0.5pt solid black; height: 12pt">Relationship</td>
                                    <td colspan="6" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Full Name</td>
                                    <td colspan="6" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Nomor KK</td> <!-- Lastname -->
                                    <td colspan="10" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Date of Birth</td>
                                    <td colspan="10" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Email</td>
                                    <td colspan="6" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">KTP Keluarga</td>
                                    <td colspan="5" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Address</td>
                                    <td colspan="8" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">No. Telp</td>
                                </tr>
                                @{
                                    bool hasSpouse = false;
                                    bool hasChild = false;

                                    var distinctCurriculumVitae = nomineeFamilyData.DistinctBy(x => x["FamilyRelationship"].ToString());

                                    foreach (var list in distinctCurriculumVitae)
                                    {
                                        if (!list["FamilyRelationship"].ToString().Equals("Child"))
                                        {
                                            hasSpouse = true;
                                            // TODO: Generate HTML table row for spouse/parent.
                                            <tr height="18" style="height: 12pt">
                                                <td colspan="9" height="18" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamilyRelationship"]</td>
                                                <td colspan="6" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamilyFirstName"]</td>
                                                <td colspan="6" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamilyLastName"]</td>
                                                <td colspan="10" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(((DateTime)list["FamilyDateOfBirth"]).ToString("dd MMM yyyy"))</td>
                                                <td colspan="10" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamilyPassportNumber"]</td>
                                                <td colspan="6" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamillyPassportDateIssued"] @*(((DateTime)list["FamillyPassportDateIssued"]).ToString("dd MMM yyyy"))*@</td>
                                                <td colspan="5" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamilyPassportPlaceIssued"]</td>
                                                <td colspan="8" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@*(((DateTime)list["FamilyPassportValidUntil"]).ToString("dd MMM yyyy"))*@</td>
                                            </tr>
                                        }
                                    }

                                    @foreach (var list in distinctCurriculumVitae) 
                                    {
                                        if (list["FamilyRelationship"].ToString().Equals("Child"))
                                        {       
                                            hasChild = true;
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="9" height="15" class="xl12729830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                                <td colspan="6" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamilyFirstName"]</td>
                                                <td colspan="6" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamilyLastName"]</td>
                                                <td colspan="10" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(((DateTime)list["FamilyDateOfBirth"]).ToString("dd MMM yyyy"))</td>
                                                <td colspan="10" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamilyPassportNumber"]</td>
                                                <td colspan="6" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; text-align: center; ; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamillyPassportDateIssued"] @*(((DateTime)list["FamillyPassportDateIssued"]).ToString("dd MMM yyyy"))*@</td>
                                                <td colspan="5" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@list["FamilyPassportPlaceIssued"]</td>
                                                <td colspan="8" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@*(((DateTime)list["FamilyPassportValidUntil"]).ToString("dd MMM yyyy"))*@</td>
                                            </tr>
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="4" height="15" class="xl9029830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">Child</td>
                                                @if (list["FamilyGender"].ToString().Equals("M"))
                                                {
                                                    <td class="xl7129830" style="border-left: none"><span style="color: black; display: inline-block; line-height: 1">&check;</span></td>
                                                }
                                                else
                                                {
                                                    <td class="xl7129830" style="border-left: solid 1px black;"></td>
                                                }
                                                <td class="xl6629830" colspan="2"><span style="mso-spacerun: yes"></span>M</td>
                                                @if (list["FamilyGender"].ToString().Equals("F"))
                                                {
                                                    <td class="xl7129830" style="padding-left: 0px"><span style="color: black; display: inline-block; line-height: 1">&check;</span></td>
                                                }
                                                else
                                                {
                                                    <td class="xl7129830" style="border-left: solid 1px black;"></td>
                                                }
                                                <td class="xl6629830" style="border-left: none"><span style="mso-spacerun: yes"></span>F</td>
                                            </tr>
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="9" height="15" class="xl9129830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                            </tr>
                                        }
                                    }

                                    @if (!hasSpouse)
                                    {
                                        <tr height="18" style="height: 12pt">
                                            <td colspan="9" height="18" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt">Spouse / Partner <sup>2</sup></td>
                                            <td colspan="6" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            <td colspan="6" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            <td colspan="10" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; text-align: center; padding-left: 0px"></td>
                                            <td colspan="10" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            <td colspan="6" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; text-align: center; padding-left: 0px"></td>
                                            <td colspan="5" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            <td colspan="8" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; text-align: center; padding-left: 0px"></td>
                                        </tr>
                                    }

                                    @if (!hasChild)
                                    {
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="9" height="15" class="xl12729830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                            <td colspan="6" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;"></td>
                                            <td colspan="6" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;"></td>
                                            <td colspan="10" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;"></td>
                                            <td colspan="10" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;"></td>
                                            <td colspan="6" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; text-align: center; ; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;"></td>
                                            <td colspan="5" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;"></td>
                                            <td colspan="8" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;"></td>
                                        </tr>
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="4" height="15" class="xl9029830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">Child</td>
                                            <td class="xl7129830" style="border-left: solid 1px black;"></td>
                                            <td class="xl6629830" colspan="2"><span style="mso-spacerun: yes"></span>M</td>
                                            <td class="xl7129830" style="border-left: solid 1px black;"></td>
                                            <td class="xl6629830" style="border-left: none"><span style="mso-spacerun: yes"></span>F</td>
                                        </tr>
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="9" height="15" class="xl9129830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                        </tr>
                                    }
                                }
                                
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="18" style="height: 12pt">
                                    <td colspan="59" height="18" class="xl7229830" style="height: 12pt"><sup></sup></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="height: 12pt">5.<span style="mso-spacerun: yes"> </span>Formal Education</td>
                                </tr>
                                <tr height="18" style="height: 12pt">
                                    @*<td height="18" class="xl7229830" style="height: 12pt"><sup></sup></td>*@
                                    <td colspan="8" class="xl10129830">Educational Level</td>
                                    <td colspan="9" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Name of School</td>
                                    <td colspan="10" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">City</td>
                                    <td colspan="12" class="xl10129830" style="border-left: none">Attachment</td>
                                    <td colspan="7" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Start Date</td>
                                    <td colspan="7" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">End Date</td>
                                    <td colspan="6" class="xl9029830" style="border-left: none"></td>
                                </tr>
                                
                                @{
                                    var distinctListFormalEducation = educationData
                                        .Select(x => new
                                        {
                                            EducationLevel = (string)x["EducationLevel"],
                                            EducationSchoolName = (string)x["EducationSchoolName"],
                                            EducationCity = (string)x["EducationCity"],
                                            EducationAttachment = (string)x["EducationAttachment"],
                                            EducationStartDate = (DateTime?)x["EducationStartDate"],
                                            EducationEndDate = (DateTime?)x["EducationEndDate"]
                                        })
                                        .Distinct()
                                        .ToList();
                                }

                                @foreach (var list in distinctListFormalEducation)
                                {
                                    <tr height="18" style="height: 12pt">
                                        <td colspan="8" class="xl7129830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.EducationLevel ?? "")</td>
                                        <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.EducationSchoolName ?? "")</td>
                                        <td colspan="10" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.EducationCity ?? "")</td>
                                        <td colspan="12" class="xl7129830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: center;">
                                            @if (list.EducationAttachment != null)
                                            {
                                                <a href="#" target="_blank" style="text-decoration: underline; color: blue;">Attachment</a>
                                            }
                                        </td>
                                        <td colspan="7" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.EducationStartDate?.ToString("dd MMM yyyy"))</td>
                                        <td colspan="7" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.EducationEndDate?.ToString("dd MMM yyyy"))</td>
                                        <td colspan="6" class="xl9029830" style="border-left: none"></td>
                                    </tr>
                                }
                                <tr height="18" style="height: 12pt">
                                    <td colspan="59" height="18" class="xl7229830" style="height: 12pt"><sup></sup></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="height: 12pt">6.<span style="mso-spacerun: yes"> </span>Medical Certificate / Test</td>
                                </tr>
                                <tr height="18" style="height: 12pt">
                                    @*<td height="18" class="xl7229830" style="height: 12pt"><sup></sup></td>*@
                                    <td colspan="8" class="xl10129830">Medical Test</td>
                                    <td colspan="9" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Number</td>
                                    <td colspan="12" class="xl10129830" style="border-left: none">Place of Issue</td>
                                    <td colspan="8" class="xl10129830" style="border-left: none">Date of Issue</td>
                                    <td colspan="8" class="xl10129830" style="border-left: none">Expiration</td>
                                    <td colspan="8" class="xl10129830" style="border-left: none">Attachment*</td>
                                    <td colspan="5" class="xl9029830" style="border-left: none"></td>
                                </tr>

                                @foreach (var list in medicalCertificateData.Select(x => new
                                    {
                                        MedicalCertificateName = (string)x["MedicalCertificateName"],
                                        MedicalCertificateNumber = (string)x["MedicalCertificateNumber"],
                                        MedicalCertificatePlaceOfIssue = (string)x["MedicalCertificatePlaceOfIssue"],
                                        MedicalCertificateDateOfIssue = (DateTime?)x["MedicalCertificateDateOfIssue"],
                                        MedicalCertificateExpirationDate = (DateTime?)x["MedicalCertificateExpirationDate"],
                                        MedicalCertificateAttachment = (string)x["MedicalCertificateAttachment"]
                                    })
                                    .Distinct())
                                    {
                                        <tr height="18" style="height: 12pt">
                                            <!-- Code omitted for brevity -->
                                            <td colspan="8" class="xl7129830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.MedicalCertificateName ?? "")</td>
                                            <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.MedicalCertificateNumber ?? "")</td>
                                            <td colspan="12" class="xl7129830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">@(list.MedicalCertificatePlaceOfIssue ?? "")</td>
                                            <td colspan="8" class="xl7129830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px; text-align: center;">
                                                @if (list.MedicalCertificateDateOfIssue != null)
                                                {
                                                    @(((DateTime?)list.MedicalCertificateDateOfIssue)?.ToString("dd MMM yyyy"))
                                                }
                                            </td>
                                            <td colspan="8" class="xl7129830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px; text-align: center;">
                                                @if (list.MedicalCertificateExpirationDate != null)
                                                {
                                                    @(((DateTime?)list.MedicalCertificateExpirationDate)?.ToString("dd MMM yyyy"))
                                                }
                                            </td>
                                            <td colspan="8" class="xl7129830" style="border-left: none; text-align: center; white-space: normal; word-break: break-word; padding-left: 5px; padding-right:3px;">
                                                @if (list.MedicalCertificateAttachment != null)
                                                {
                                                    <a href="#" target="_blank" style="text-decoration: underline; color: blue;">Attachment</a>
                                                }
                                            </td>
                                            <td colspan="5" class="xl9029830" style="border-left: none"></td>
                                        </tr>
                                    }
                                <tr height="18" style="height: 12pt">
                                    <td colspan="59" height="18" class="xl7229830" style="height: 12pt"><sup></sup></td>
                                </tr>
                                <tr height="15" style="height: 12pt" >
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="height: 12pt">7.<span style="mso-spacerun: yes"> </span>STCW-1978 (As Amended) Compliant Certificates / Courses and Other Qualifications:-</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl9229830" style="height: 12pt">(Add separate sheet if data exceeds space available)</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="13" rowspan="2" height="30" class="xl10629830" width="184" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 22.8pt; width: 137pt">Description of Cert / Course</td>
                                    <td colspan="6" rowspan="2" class="xl10629830" width="93" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 69pt">Country of issue</td>
                                    <td colspan="11" rowspan="2" class="xl10629830" width="102" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 75pt">Number</td>
                                    <td colspan="6" rowspan="2" class="xl10629830" width="77" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 56pt">Date of Issue</td>
                                    <td colspan="6" rowspan="2" class="xl10629830" width="71" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 52pt">Date of Expiry</td>
                                    <td colspan="8" rowspan="2" class="xl10629830" width="116" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 87pt">Place of issue<span style="mso-spacerun: yes"></span></td>
                                    <td colspan="9" rowspan="2" class="xl10629830" width="107" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 78pt">Issuing Authority /<span style="mso-spacerun: yes"> </span>body</td>
                                </tr>
                                @{
                                    var tempCrewId = compliantCertificateCourseData[0]["CrewId"].ToString();

                                    if (!string.IsNullOrEmpty(tempCrewId)) {
                                        string sqlQueryCertRegA = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + tempCrewId + "' AND CrewCertificateCategory LIKE '%(A) Reg 1%'";
                                        var newRsCertA = ExecuteRows(sqlQueryCertRegA);

                                        string sqlQueryCertRegB = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + tempCrewId + "' AND CrewCertificateCategory LIKE '%(B) Reg VI/1 - Basic Safety Training%'";
                                        var newRsCertB = ExecuteRows(sqlQueryCertRegB);

                                        string sqlQueryCertRegC = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + tempCrewId + "' AND CrewCertificateCategory LIKE '%(C) Reg VI/ 2-4 Additional Training%'";
                                        var newRsCertC = ExecuteRows(sqlQueryCertRegC);

                                        string sqlQueryCertRegD = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + tempCrewId + "' AND CrewCertificateCategory LIKE '%(D) Reg II / 1-4, III / 1-4 Others Certificate of Competency & Ratings Watch-keeping Certificate (Including flag state endorsements)%'";
                                        var newRsCertD = ExecuteRows(sqlQueryCertRegD);

                                        string sqlQueryCertRegE = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + tempCrewId + "' AND (CrewCertificateCategory LIKE '%(E) Other mandatory/recommended Certificates/Courses%' OR CrewCertificateCategory LIKE '%X%')";
                                        var newRsCertE = ExecuteRows(sqlQueryCertRegE);

                                        string sqlQueryCertRegF = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + tempCrewId + "' AND CrewCertificateCategory LIKE '%(F) GMDSS Certificates (including flag state endorsements)%'";
                                        var newRsCertF = ExecuteRows(sqlQueryCertRegF);

                                        string sqlQueryCertRegG = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + tempCrewId + "' AND CrewCertificateCategory LIKE '%(G) Reg V/1 - Special Requirement for Tankers%'";
                                        var newRsCertG = ExecuteRows(sqlQueryCertRegG);

                                        string sqlQueryCertRegH = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + tempCrewId + "' AND CrewCertificateCategory LIKE '%(H) V/2 and V/3 - Special requirement for passenger / Ro-Ro Passenger Vessels%'";
                                        var newRsCertH = ExecuteRows(sqlQueryCertRegH);

                                        string sqlQueryCertRegX = "SELECT * FROM vw_VitaeCrewCompliantCertificatesCourseData WHERE CrewId = '" + tempCrewId + "' AND CrewCertificateCategory LIKE '%X%'";
                                        var newRsCertX = ExecuteRows(sqlQueryCertRegX);

                                        <tr height="15" style="height: 12pt"></tr>
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                        </tr>
                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl12129830" style="height: 12pt">(A)<span style="mso-spacerun: yes"> </span>Reg 1</td>
                                        </tr>
                                        
                                        if (newRsCertA.Any())
                                        {
                                            var distinctRsCertA = newRsCertA
                                                .Select(x => new
                                                {
                                                    CrewCertificateDescription = (string)x["CrewCertificateDescription"],
                                                    CrewCertificateCountryIssue = (string)x["CrewCertificateCountryIssue"],
                                                    CrewCertificateNumber = (string)x["CrewCertificateNumber"],
                                                    CrewCertificateDateOfIssue = (DateTime)x["CrewCertificateDateOfIssue"],
                                                    CrewCertificateDateOfExpiry = (string)x["CrewCertificateDateOfExpiry"],
                                                    CrewCertificatePlaceOfIssue = (string)x["CrewCertificatePlaceOfIssue"],
                                                    CrewCertificateIssuingAuthority = (string)x["CrewCertificateIssuingAuthority"]
                                                })
                                                .Distinct();

                                            foreach (var list in distinctRsCertA)
                                            {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDescription</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateCountryIssue</td>
                                                    <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateNumber</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfIssue.ToString("dd/MM/yyyy")</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfExpiry</td>
                                                    <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificatePlaceOfIssue</td>
                                                    <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateIssuingAuthority</td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            </tr>
                                        }
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                        </tr>
                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl12129830" style="height: 12pt">(B)<span style="mso-spacerun: yes"> </span>Reg VI/1 - Basic Safety Training</td>
                                        </tr>

                                        if (newRsCertB.Any())
                                        {
                                            var distinctRsCertB = newRsCertB
                                                .Select(x => new
                                                {
                                                    CrewCertificateDescription = (string)x["CrewCertificateDescription"],
                                                    CrewCertificateCountryIssue = (string)x["CrewCertificateCountryIssue"],
                                                    CrewCertificateNumber = (string)x["CrewCertificateNumber"],
                                                    CrewCertificateDateOfIssue = (DateTime)x["CrewCertificateDateOfIssue"],
                                                    CrewCertificateDateOfExpiry = (string)x["CrewCertificateDateOfExpiry"],
                                                    CrewCertificatePlaceOfIssue = (string)x["CrewCertificatePlaceOfIssue"],
                                                    CrewCertificateIssuingAuthority = (string)x["CrewCertificateIssuingAuthority"]
                                                })
                                                .Distinct();

                                            foreach (var list in distinctRsCertB)
                                            {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDescription</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateCountryIssue</td>
                                                    <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateNumber</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfIssue.ToString("dd/MM/yyyy")</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfExpiry</td>
                                                    <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificatePlaceOfIssue</td>
                                                    <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateIssuingAuthority</td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            </tr>
                                        }
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                        </tr>

                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl12129830" style="height: 12pt">(C)<span style="mso-spacerun: yes"> </span>Reg VI/ 2-4 Additional Training</td>
                                        </tr>
                                        @if(newRsCertC.Any())
                                        {
                                            var distinctRsCertC = newRsCertC
                                                .Select(x => new
                                                {
                                                    CrewCertificateDescription = (string)x["CrewCertificateDescription"],
                                                    CrewCertificateCountryIssue = (string)x["CrewCertificateCountryIssue"],
                                                    CrewCertificateNumber = (string)x["CrewCertificateNumber"],
                                                    CrewCertificateDateOfIssue = (DateTime)x["CrewCertificateDateOfIssue"],
                                                    CrewCertificateDateOfExpiry = (DateTime)x["CrewCertificateDateOfExpiry"],
                                                    CrewCertificatePlaceOfIssue = (string)x["CrewCertificatePlaceOfIssue"],
                                                    CrewCertificateIssuingAuthority = (string)x["CrewCertificateIssuingAuthority"]
                                                })
                                                .Distinct();

                                            foreach(var list in distinctRsCertC)
                                            {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDescription</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateCountryIssue</td>
                                                    <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateNumber</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfIssue.ToString("dd MMM yyyy")</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfExpiry.ToString("dd MMM yyyy")</td>
                                                    <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificatePlaceOfIssue</td>
                                                    <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateIssuingAuthority</td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            </tr>
                                        }

                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                        </tr>

                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl13029830" width="750" style="height: 12pt; width: 554pt">
                                                (D) <font class="font1029830"><sub>4</sub></font><font class="font529830"><span style="mso-spacerun: yes"> </span>Reg II / 1-4, III / 1-4 Others Certificate of Competency &amp; Ratings Watch-keeping Certificate (Including flag state endorsements)</font>
                                            </td>
                                        </tr>
                                        <tr height="16" style="height: 12pt">
                                            <td colspan="13" height="16" class="xl10129830" style="height: 12pt">COC / Endorsement</td>
                                            <td colspan="6" class="xl10229830" width="93" style="border-right: 0.5pt solid black; border-left: none; width: 69pt">Issuing Authority</td>
                                            <td colspan="11" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Number</td>
                                            <td colspan="6" class="xl10229830" width="77" style="border-right: 0.5pt solid black; border-left: none; width: 56pt">Date of Issue</td>
                                            <td colspan="6" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Expiration</td>
                                            <td colspan="8" class="xl7529830" style="border-right: 0.5pt solid black; border-left: none">Attachment*</td>
                                            <td colspan="9" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                        </tr>
                                        @if(newRsCertD.Any())
                                        {
                                            var distinctRsCertD = newRsCertD
                                                .Select(x => new
                                                {
                                                    CrewCertificateDescription = (string)x["CrewCertificateDescription"],
                                                    CrewCertificateIssuingAuthority = (string)x["CrewCertificateIssuingAuthority"],
                                                    CrewCertificateNumber = (string)x["CrewCertificateNumber"],
                                                    CrewCertificateDateOfIssue = (DateTime)x["CrewCertificateDateOfIssue"],
                                                    CrewCertificateDateOfExpiry = (DateTime)x["CrewCertificateDateOfExpiry"]
                                                })
                                                .Distinct();

                                            foreach(var list in distinctRsCertD)
                                            {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDescription</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateIssuingAuthority</td>
                                                    <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateNumber</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfIssue.ToString("dd/MM/yyyyy")</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfExpiry</td>
                                                    <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Link Attachment</td>
                                                    <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            </tr>
                                        }

                                        <tr height="18" style="height: 12pt">
                                            <td colspan="59" height="18" class="xl13529830" style="height: 12pt">
                                                <sup>4</sup><font class="font729830">Enter here actual description given in the Competency Certificate / Watchkeeping Certificate held by you<span style="mso-spacerun: yes"></span></font>
                                            </td>
                                        </tr>
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                        </tr>
                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl12429830" style="height: 12pt">(E)<span style="mso-spacerun: yes"> </span>Other mandatory/recommended Certificates / Courses - (as applicable)</td>
                                        </tr>
                                        @if(newRsCertE.Any())
                                        {
                                            var distinctRsCertE = newRsCertE
                                                .Select(x => new
                                                {
                                                    CrewCertificateDescription = (string)x["CrewCertificateDescription"],
                                                    CrewCertificateIssuingAuthority = (string)x["CrewCertificateIssuingAuthority"],
                                                    CrewCertificateNumber = (string)x["CrewCertificateNumber"],
                                                    CrewCertificateDateOfIssue = (DateTime)x["CrewCertificateDateOfIssue"],
                                                    CrewCertificateDateOfExpiry = (DateTime)x["CrewCertificateDateOfExpiry"]
                                                })
                                                .Distinct();

                                            foreach(var list in distinctRsCertE)
                                            {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDescription</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left;">@list.CrewCertificateIssuingAuthority</td>
                                                    <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateNumber</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfIssue.ToString("dd MMM yyyy")</td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfExpiry.ToString("dd MMM yyyy")</td>
                                                    <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"><a href="#" target="_blank" style="text-decoration: underline; color: blue;">Attachment</a></td>
                                                    <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="13" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="11" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="8" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                                <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none"></td>
                                            </tr>
                                        }
                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl12129830" style="height: 12pt"></td>
                                        </tr>
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="17" rowspan="2" height="30" class="xl18829830" width="248" style="height: 22.8pt; width: 184pt">Description of Cert / Course</td>
                                            <td colspan="9" rowspan="2" class="xl18829830" width="87" style="width: 65pt">Country of<span style="mso-spacerun: yes"> </span>Issue</td>
                                            <td colspan="7" rowspan="2" class="xl18829830" width="81" style="width: 59pt">Number</td>
                                            <td colspan="6" rowspan="2" class="xl18829830" width="83" style="width: 60pt">Date of Issue</td>
                                            <td colspan="5" rowspan="2" class="xl18829830" width="59" style="width: 45pt">Date of Expiry</td>
                                            <td colspan="5" rowspan="2" class="xl18829830" width="74" style="width: 55pt">Place of Issue</td>
                                            <td colspan="10" rowspan="2" class="xl18829830" width="118" style="width: 86pt">Issuing Authority /<span style="mso-spacerun: yes"> </span>body</td>
                                        </tr>
                                        <tr height="15" style="height: 12pt"></tr>
                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl18729830" width="750" style="height: 12pt; width: 554pt"></td>
                                        </tr>
                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl12129830" style="height: 12pt">(F)<span style="mso-spacerun: yes"> </span>GMDSS Certificates <font class="font929830">(including flag state endorsements)</font></td>
                                        </tr>
                                        @if(newRsCertF.Any())
                                        {
                                            var distinctRsCertF = newRsCertF
                                                .Select(x => new
                                                {
                                                    CrewCertificateDescription = (string)x["CrewCertificateDescription"],
                                                    CrewCertificateCountryIssue = (string)x["CrewCertificateCountryIssue"],
                                                    CrewCertificateNumber = (string)x["CrewCertificateNumber"],
                                                    CrewCertificateDateOfIssue = (DateTime)x["CrewCertificateDateOfIssue"],
                                                    CrewCertificateDateOfExpiry = (DateTime)x["CrewCertificateDateOfExpiry"],
                                                    CrewCertificatePlaceOfIssue = (string)x["CrewCertificatePlaceOfIssue"],
                                                    CrewCertificateIssuingAuthority = (string)x["CrewCertificateIssuingAuthority"]
                                                })
                                                .Distinct();

                                            foreach(var list in distinctRsCertF)
                                            {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="17" height="15" class="xl7129830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDescription</td>
                                                    <td colspan="9" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateCountryIssue</td>
                                                    <td colspan="7" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateNumber</td>
                                                    <td colspan="6" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfIssue.ToString("dd/MM/yyyy")</td>
                                                    <td colspan="5" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfExpiry.ToString("dd/MM/yyyy")</td>
                                                    <td colspan="5" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificatePlaceOfIssue</td>
                                                    <td colspan="10" class="xl7129830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateIssuingAuthority</td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="17" height="15" class="xl7129830" style="height: 12pt"></td>
                                                <td colspan="9" class="xl6529830" style="border-left: none"></td>
                                                <td colspan="7" class="xl6529830" style="border-left: none"></td>
                                                <td colspan="6" class="xl6529830" style="border-left: none"></td>
                                                <td colspan="5" class="xl6529830" style="border-left: none"></td>
                                                <td colspan="5" class="xl6529830" style="border-left: none"></td>
                                                <td colspan="10" class="xl7129830" style="border-left: none"></td>
                                            </tr>
                                        }
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl8229830" style="height: 12pt"></td>
                                        </tr>
                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl12129830" style="height: 12pt">(G)<span style="mso-spacerun: yes"> </span>Reg V/ 1 - Special Requirement for Tankers</td>
                                        </tr>
                                        <tr height="35" style="mso-height-source: userset; height: 26.4pt">
                                            <td colspan="17" rowspan="2" height="70" class="xl18829830" width="248" style="height: 52.8pt; width: 184pt">Description</td>
                                            <td colspan="9" rowspan="2" class="xl18829830" width="87" style="width: 65pt">Level 1: Incharge<span style="mso-spacerun: yes"> </span>Level 2:Asst.</td>
                                            <td colspan="7" rowspan="2" class="xl18929830" width="81" style="width: 59pt">Country of Issue</td>
                                            <td colspan="6" rowspan="2" class="xl18929830" width="83" style="width: 60pt">Number</td>
                                            <td colspan="5" rowspan="2" class="xl18929830" width="59" style="width: 45pt">Date of Issue</td>
                                            <td colspan="5" rowspan="2" class="xl18929830" width="74" style="width: 55pt">Place of Issue</td>
                                            <td colspan="10" rowspan="2" class="xl18929830" width="118" style="width: 86pt">Issuing Authority /<span style="mso-spacerun: yes"> </span>body</td>
                                        </tr>
                                        <tr height="35" style="mso-height-source: userset; height: 26.4pt"></tr>
                                        {
                                            bool isEndorsementOil = false;
                                            bool isEndorsementChemical = false;
                                            bool isEndorsementGas = false;

                                            bool isTankerFamiliarisationOilPage1 = false;
                                            bool isTankerFamiliarisationChemicalPage1 = false;
                                            bool isTankerFamiliarisationGasPage1 = false;

                                            bool isTankerFamiliarisationOilPage2 = false;
                                            bool isTankerFamiliarisationChemicalPage2 = false;
                                            bool isTankerFamiliarisationGasPage2 = false;
                                            
                                            var distinctCertG = newRsCertG.DistinctBy(list => list["CrewCertificateDescription"]).ToList();
                                            
                                            // Endorsemen Oil
                                            foreach (var list in distinctCertG)
                                            {
                                                if (list["CrewCertificateDescription"].ToString().Equals("Endorsement - Oil"))
                                                {
                                                    isEndorsementOil = true;
                                                    <tr height="15" style="height: 12pt">
                                                        <td colspan="17" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Endorsement - Oil</td>
                                                        <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: center;">@list["CrewCertificateTankerLevel"]</td>
                                                        <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateCountryIssue"]</td>
                                                        <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateNumber"]</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)list["CrewCertificateDateOfIssue"]).ToString("dd/MM/yyyyy"))</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificatePlaceOfIssue"]</td>
                                                        <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateIssuingAuthority"]</td>
                                                    </tr>
                                                }
                                            }

                                            // Endorsemen Chemical
                                            foreach (var list in distinctCertG) {
                                                if (list["CrewCertificateDescription"].ToString().Equals("Endorsement - Chemical")) {
                                                    isEndorsementChemical = true;
                                                    <tr height="15" style="height: 12pt">
                                                        <td colspan="17" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Endorsement - Chemical</td>
                                                        <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: center;">@list["CrewCertificateTankerLevel"]</td>
                                                        <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateCountryIssue"]</td>
                                                        <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateNumber"]</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)list["CrewCertificateDateOfIssue"]).ToString("dd/MM/yyyyy"))</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificatePlaceOfIssue"]</td>
                                                        <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateIssuingAuthority"]</td>
                                                    </tr>
                                                }
                                            }
                                            // Endorsemen Gas
                                            foreach (var list in distinctCertG) {
                                                if (list["CrewCertificateDescription"].ToString().Equals("Endorsement - Gas")) {
                                                    isEndorsementGas = true;
                                                    <tr height="15" style="height: 12pt">
                                                        <td colspan="17" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Endorsement - Gas</td>
                                                        <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: center;">@list["CrewCertificateTankerLevel"]</td>
                                                        <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateCountryIssue"]</td>
                                                        <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateNumber"]</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)list["CrewCertificateDateOfIssue"]).ToString("dd/MM/yyyyy"))</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificatePlaceOfIssue"]</td>
                                                        <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateIssuingAuthority"]</td>
                                                    </tr>
                                                }
                                            }
                                            // Tanker Familiarisation OIL PAGE 1
                                            foreach (var list in distinctCertG) {
                                                if (list["CrewCertificateDescription"].ToString().Equals("Tanker Familiarisation (Oil) Page 1")) {
                                                    isTankerFamiliarisationOilPage1 = true;
                                                    <tr height="15" style="height: 12pt">
                                                        <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Tanker Familiarisation</td>
                                                        <td colspan="5" class="xl11329830">(Oil)</td>
                                                        <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 1</td>
                                                        <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateCountryIssue"]</td>
                                                        <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateNumber"]</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)list["CrewCertificateDateOfIssue"]).ToString("dd/MM/yyyyy"))</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificatePlaceOfIssue"]</td>
                                                        <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateIssuingAuthority"]</td>
                                                    </tr>
                                                }
                                            }
                                            // Tanker Familiarisation Chemical Page 1
                                            foreach (var list in distinctCertG) {
                                                if (list["CrewCertificateDescription"].ToString().Equals("Tanker Familiarisation (Chemical) Page 1")) {
                                                    isTankerFamiliarisationChemicalPage1 = true;
                                                    <tr height="15" style="height: 12pt">
                                                        <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Tanker Familiarisation</td>
                                                        <td colspan="5" class="xl11329830">(Chemical)</td>
                                                        <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 1</td>
                                                        <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateCountryIssue"]</td>
                                                        <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateNumber"]</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)list["CrewCertificateDateOfIssue"]).ToString("dd/MM/yyyyy"))</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificatePlaceOfIssue"]</td>
                                                        <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateIssuingAuthority"]</td>
                                                    </tr>
                                                }
                                            }
                                            // Tanker Familiarisation Gas Page 1
                                            foreach (var list in distinctCertG) {
                                                if (list["CrewCertificateDescription"].ToString().Equals("Tanker Familiarisation (Gas) Page 1")) {
                                                    isTankerFamiliarisationGasPage1 = true;
                                                    <tr height="15" style="height: 12pt">
                                                        <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Tanker Familiarisation</td>
                                                        <td colspan="5" class="xl11329830">(Gas)</td>
                                                        <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 1</td>
                                                        <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateCountryIssue"]</td>
                                                        <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateNumber"]</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)list["CrewCertificateDateOfIssue"]).ToString("dd/MM/yyyyy"))</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificatePlaceOfIssue"]</td>
                                                        <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateIssuingAuthority"]</td>
                                                    </tr>
                                                }
                                            }
                                            // Tanker Special Tanker Safety OIL Page 2
                                            foreach (var list in distinctCertG) {
                                                if (list["CrewCertificateDescription"].ToString().Equals("Special Tanker Safety (Oil) Page 2")) {
                                                    isTankerFamiliarisationOilPage2 = true;
                                                    <tr height="15" style="height: 12pt">
                                                        <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Special Tanker Safety</td>
                                                        <td colspan="5" class="xl11329830">(Oil)</td>
                                                        <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 2</td>
                                                        <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateCountryIssue"]</td>
                                                        <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateNumber"]</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)list["CrewCertificateDateOfIssue"]).ToString("dd/MM/yyyyy"))</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificatePlaceOfIssue"]</td>
                                                        <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateIssuingAuthority"]</td>
                                                    </tr>
                                                }
                                            }
                                            // Tanker Special Tanker Safety Chemical Page 2
                                            foreach (var list in distinctCertG) {
                                                if (list["CrewCertificateDescription"].ToString().Equals("Special Tanker Safety (Chemical) Page 2")) {
                                                    isTankerFamiliarisationChemicalPage2 = true;
                                                    <tr height="15" style="height: 12pt">
                                                        <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Special Tanker Safety</td>
                                                        <td colspan="5" class="xl11329830">(Chemical)</td>
                                                        <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 2</td>
                                                        <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateCountryIssue"]</td>
                                                        <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateNumber"]</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)list["CrewCertificateDateOfIssue"]).ToString("dd/MM/yyyyy"))</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificatePlaceOfIssue"]</td>
                                                        <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateIssuingAuthority"]</td>
                                                    </tr>
                                                }
                                            }
                                            // Tanker Special Tanker Safety Gas PAGE 2 
                                            foreach (var list in distinctCertG) {
                                                if (list["CrewCertificateDescription"].ToString().Equals("Special Tanker Safety (Gas) Page 2")) {
                                                    isTankerFamiliarisationGasPage2 = true;
                                                    <tr height="15" style="height: 12pt">
                                                        <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Special Tanker Safety</td>
                                                        <td colspan="5" class="xl11329830">(Gas)</td>
                                                        <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 2</td>
                                                        <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateCountryIssue"]</td>
                                                        <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateNumber"]</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)list["CrewCertificateDateOfIssue"]).ToString("dd/MM/yyyyy"))</td>
                                                        <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificatePlaceOfIssue"]</td>
                                                        <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list["CrewCertificateIssuingAuthority"]</td>
                                                    </tr>
                                                }
                                            }

                                            if(!isEndorsementOil) {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="17" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Endorsement - Oil</td>
                                                    <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                            if(!isEndorsementChemical) {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="17" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Endorsement - Chemical</td>
                                                    <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                            if(!isEndorsementGas) {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="17" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Endorsement - Gas</td>
                                                    <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                            if(!isTankerFamiliarisationOilPage1) {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Tanker Familiarisation</td>
                                                    <td colspan="5" class="xl11329830">(Oil)</td>
                                                    <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 1</td>
                                                    <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                            if(!isTankerFamiliarisationChemicalPage1) {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Tanker Familiarisation</td>
                                                    <td colspan="5" class="xl11329830">(Chemical)</td>
                                                    <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 1</td>
                                                    <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                            if(!isTankerFamiliarisationGasPage1) {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Tanker Familiarisation</td>
                                                    <td colspan="5" class="xl11329830">(Gas)</td>
                                                    <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 1</td>
                                                    <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                            if(!isTankerFamiliarisationOilPage2) {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Special Tanker Safety	</td>
                                                    <td colspan="5" class="xl11329830">(Oil)</td>
                                                    <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 2</td>
                                                    <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                            if(!isTankerFamiliarisationChemicalPage2) {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Special Tanker Safety	</td>
                                                    <td colspan="5" class="xl11329830">(Chemical)</td>
                                                    <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 2</td>
                                                    <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                            if(!isTankerFamiliarisationGasPage2) {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="9" height="15" class="xl11229830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Special Tanker Safety	</td>
                                                    <td colspan="5" class="xl11329830">(Gas)</td>
                                                    <td colspan="12" class="xl11329830" style="border-right: 0.5pt solid black">Page 2</td>
                                                    <td colspan="7" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="6" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="5" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                    <td colspan="10" class="xl9429830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                </tr>
                                            }
                                        }
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                        </tr>
                                        <tr height="16" style="height: 12pt">
                                            <td colspan="59" height="16" class="xl12429830" style="height: 12pt">(H)<span style="mso-spacerun: yes"> </span>V/2 and V/3 - Special requirement for passenger / Ro-Ro Passenger Vessels</td>
                                        </tr>
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="17" rowspan="2" height="56" class="xl18129830" width="248" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 42pt; width: 184pt">Description</td>
                                            <td colspan="9" rowspan="2" class="xl10629830" width="87" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 65pt">Vsl Type-Pax / RoRoPax</td>
                                            <td colspan="7" rowspan="2" class="xl10629830" width="81" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 59pt">Country of Issue</td>
                                            <td colspan="6" rowspan="2" class="xl10629830" width="83" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 60pt">Number</td>
                                            <td colspan="5" rowspan="2" class="xl10629830" width="59" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 45pt">Date of Issue</td>
                                            <td colspan="5" rowspan="2" class="xl10629830" width="74" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 55pt">Place of Issue</td>
                                            <td colspan="10" rowspan="2" class="xl10629830" width="118" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; width: 86pt">Issuing Authority /<span style="mso-spacerun: yes"> </span>body</td>
                                        </tr>
                                        <tr height="41" style="mso-height-source: userset; height: 30.6pt"></tr>
                                        @if (newRsCertH.Any())
                                        {
                                            var distinctRsCertH = newRsCertH
                                                .Select(x => new
                                                {
                                                    CrewCertificateDescription = (string)x["CrewCertificateDescription"],
                                                    CrewCertificatePassengerVesselType = (string)x["CrewCertificatePassengerVesselType"],
                                                    CrewCertificateCountryIssue = (string)x["CrewCertificateCountryIssue"],
                                                    CrewCertificateNumber = (string)x["CrewCertificateNumber"],
                                                    CrewCertificateDateOfIssue = (DateTime)x["CrewCertificateDateOfIssue"],
                                                    CrewCertificatePlaceOfIssue = (string)x["CrewCertificatePlaceOfIssue"],
                                                    CrewCertificateIssuingAuthority = (string)x["CrewCertificateIssuingAuthority"]
                                                })
                                                .Distinct();

                                            foreach (var list in distinctRsCertH)
                                            {
                                                <tr height="15" style="height: 12pt">
                                                    <td colspan="17" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDescription</td>
                                                    <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificatePassengerVesselType</td>
                                                    <td colspan="7" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateCountryIssue</td>
                                                    <td colspan="6" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateNumber</td>
                                                    <td colspan="5" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateDateOfIssue.ToString("dd/MM/yyyy")</td>
                                                    <td colspan="5" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificatePlaceOfIssue</td>
                                                    <td colspan="10" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewCertificateIssuingAuthority</td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr height="15" style="height: 12pt">
                                                <td colspan="17" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                <td colspan="7" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                <td colspan="6" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                <td colspan="5" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                <td colspan="5" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                                <td colspan="10" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                            </tr>
                                        }
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                        </tr>
                                    }
                                    else
                                    {
                                        throw new Exception("Missing database ID");
                                    }
                                }
                                
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12429830" style="height: 12pt">8. Sea Experience: <font class="font929830">(Last 10 years; Start the listing below with the most recent experience)</font></td>
                                </tr>
                                <tr height="16" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="7" rowspan="2" height="34" class="xl10129830" style="height: 25.2pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Company</td>
                                    <td colspan="5" rowspan="2" class="xl10129830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Flag &amp; Vessel Name</td>
                                    <td colspan="5" rowspan="2" class="xl10129830">
                                        Type<font class="font629830"><sup>(1)</sup></font>
                                    </td>
                                    <td colspan="5" rowspan="2" class="xl10129830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">GRT</td>
                                    <td colspan="6" rowspan="2" class="xl10129830"style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">DWT</td>
                                    <td colspan="5" rowspan="2" class="xl18929830" width="66" style="width: 48pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">
                                        Main Engine<font class="font629830"><sup>2</sup></font>
                                    </td>
                                    <td colspan="5" rowspan="2" class="xl10129830">BHP</td>
                                    <td colspan="4" rowspan="2" class="xl10129830">Rank</td>
                                    <td colspan="5" class="xl10129830" style="border-left: none">Sign On</td>
                                    <td colspan="6" class="xl10129830" style="border-left: none">Sign Off</td>
                                    <td colspan="6" class="xl18929830" width="71" style="border-left: none; width: 52pt">Duration</td>
                                </tr>
                                <tr height="18" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="3" height="18" class="xl10129830" style="height: 12pt; border-left: none">Date</td>
                                    <td colspan="2" class="xl10129830" style="border-left: none">Port</td>
                                    <td colspan="3" class="xl10129830" style="border-left: none">Date</td>
                                    <td colspan="3" class="xl10129830" style="border-left: none">Port</td>
                                    <td colspan="6" class="xl10129830" style="border-left: none">Reason</td>
                                </tr>
                                @{
                                    var tenYearsAgo = DateTime.Now.AddYears(-10);

                                    var distinctListCrewExperience = seaExperienceData
                                        .Select(item => new {
                                            CrewExperienceDateFrom = (DateTime)item["CrewExperienceDateFrom"],
                                            CrewExperienceDateUntil = (DateTime)item["CrewExperienceDateUntil"],
                                            CrewExperienceCompanyName = (string)item["CrewExperienceCompanyName"],
                                            CrewExperienceFlagCountry = (string)item["CrewExperienceFlagCountry"],
                                            CrewExperienceVesselName = (string)item["CrewExperienceVesselName"],
                                            CrewExperienceVesselType = (string)item["CrewExperienceVesselType"],
                                            CrewExperienceGRT = (int)item["CrewExperienceGRT"],
                                            CrewExperienceDWT = (int)item["CrewExperienceDWT"],
                                            CrewExperienceMainEngine = (string)item["CrewExperienceMainEngine"],
                                            CrewExperienceBHP = (int)item["CrewExperienceBHP"],
                                            CrewExperienceRank = (string)item["CrewExperienceRank"],
                                            CrewExperienceSignOnPort = (string)item["CrewExperienceSignOnPort"],
                                            CrewExperienceSignOffPort = (string)item["CrewExperienceSignOffPort"],
                                            CrewExperienceSignOffReason = (string)item["CrewExperienceSignOffReason"],
                                            CrewExperienceDuration = item["CrewExperienceDuration"] != null ? (int)item["CrewExperienceDuration"] : 0
                                        })
                                        .Distinct()
                                        .OrderByDescending(item => item.CrewExperienceDateFrom);
                                    foreach (var list in distinctListCrewExperience)
                                    {
                                        var experienceDateOn = list.CrewExperienceDateFrom;
                                        if (experienceDateOn >= tenYearsAgo)
                                        {
                                            <tr height="15" style="mso-height-source: userset; height: 12pt">
                                                <td colspan="7" rowspan="2" height="33" class="xl6529830" style="height: 24.6pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left">@list.CrewExperienceCompanyName</td>
                                                <td colspan="5" rowspan="2" class="xl6529830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left">@list.CrewExperienceFlagCountry<span> @list.CrewExperienceVesselName</span></td>
                                                <td colspan="5" rowspan="2" class="xl6529830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left">@list.CrewExperienceVesselType</td>
                                                <td colspan="5" rowspan="2" class="xl6529830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left">@($"{list.CrewExperienceGRT:0,0}".Replace(",", "."))</td>
                                                <td colspan="6" rowspan="2" class="xl6529830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left">@($"{list.CrewExperienceDWT:0,0}".Replace(",", "."))</td>
                                                <td colspan="5" rowspan="2" class="xl10529830" width="66" style="width: 48pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left">@list.CrewExperienceMainEngine</td>
                                                <td colspan="5" rowspan="2" class="xl6529830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left">@($"{list.CrewExperienceBHP:0,0}".Replace(",", "."))</td>
                                                <td colspan="4" rowspan="2" class="xl6529830" style="white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left">@list.CrewExperienceRank</td>

                                                <td colspan="5" class="xl19529830" style="border-left: none; white-space: normal; word-break: break-word;">@list.CrewExperienceDateFrom.ToString("dd MMM yyyy")</td>
                                                <td colspan="6" class="xl19529830" style="border-left: none; white-space: normal; word-break: break-word;">@list.CrewExperienceDateUntil.ToString("dd MMM yyyy")</td>
                                                <td colspan="6" class="xl19629830" width="71" style="border-left: none; width: 52pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">
                                                    @{
                                                        var rankExperience = list.CrewExperienceDuration;
                                                        var rankYears = rankExperience / 365;
                                                        var rankMonths = (rankExperience % 365) / 30;
                                                        var rankDays = (rankExperience % 365) % 30;
                                                        var formattedRankExperience = $"{rankYears} Years<br/>{rankMonths} Months<br/>{rankDays} Days";
                                                    }
                                                    @Html.Raw(formattedRankExperience)
                                                </td>
                                            </tr>
                                            <tr height="18" style="mso-height-source: userset; height: 12pt">
                                                <td colspan="5" height="18" class="xl6529830" style="height: 12pt; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewExperienceSignOnPort</td>
                                                <td colspan="6" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewExperienceSignOffPort</td>
                                                <td colspan="6" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@list.CrewExperienceSignOffReason</td>
                                            </tr>
                                        }
                                    }
                                }
                                <tr height="15" style="height: 12pt" >
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="18" style="height: 12pt">
                                    <td colspan="59" height="18" class="xl7229830" style="height: 12pt"><sup>(1)</sup><font class="font729830">Use only the following abbreviations for vessel types:</font></td>
                                </tr>
                                <tr height="35" style="mso-height-source: userset; height: 26.4pt">
                                    <td colspan="3" height="35" class="xl19029830" width="45" style="height: 26.4pt; width: 35pt">B/C</td>
                                    <td colspan="8" class="xl16729830" width="114" style="border-right: 0.5pt solid black; width: 83pt">Bulk Carrier</td>
                                    <td colspan="5" class="xl19029830" width="75" style="border-left: none; width: 56pt">FPSO</td>
                                    <td colspan="9" class="xl16729830" width="90" style="border-right: 0.5pt solid black; width: 67pt">Floatg Prod Stor Offldg</td>
                                    <td colspan="5" class="xl19029830" width="55" style="border-left: none; width: 40pt">MLP</td>
                                    <td colspan="8" class="xl16729830" width="102" style="border-right: 0.5pt solid black; width: 74pt">Multi-purpose</td>
                                    <td colspan="4" class="xl19029830" width="46" style="border-left: none; width: 34pt">PAS</td>
                                    <td colspan="6" class="xl16729830" width="91" style="border-right: 0.5pt solid black; width: 68pt">Passenger Ship</td>
                                    <td colspan="3" class="xl13129830" width="36" style="border-left: none; width: 27pt">YAT</td>
                                    <td colspan="8" class="xl16729830" width="96" style="border-right: 0.5pt solid black; width: 70pt">Yacht</td>
                                </tr>
                                <tr height="35" style="mso-height-source: userset; height: 26.4pt">
                                    <td colspan="3" height="35" class="xl19029830" width="45" style="height: 26.4pt; width: 35pt">CON</td>
                                    <td colspan="8" class="xl16729830" width="114" style="border-right: 0.5pt solid black; width: 83pt">Cellular Container</td>
                                    <td colspan="5" class="xl19029830" width="75" style="border-left: none; width: 56pt">GCD</td>
                                    <td colspan="9" class="xl16729830" width="90" style="border-right: 0.5pt solid black; width: 67pt">General Cargo</td>
                                    <td colspan="5" class="xl19029830" width="55" style="border-left: none; width: 40pt">MSV</td>
                                    <td colspan="8" class="xl16729830" width="102" style="border-right: 0.5pt solid black; width: 74pt">Multi Service<span style="mso-spacerun: yes"></span></td>
                                    <td colspan="4" class="xl19029830" width="46" style="border-left: none; width: 34pt">RFG</td>
                                    <td colspan="6" class="xl16729830" width="91" style="border-right: 0.5pt solid black; width: 68pt">Reefer Vessel</td>
                                    <td colspan="3" class="xl13129830" width="36" style="border-left: none; width: 27pt">TNB</td>
                                    <td colspan="8" class="xl16729830" width="96" style="border-right: 0.5pt solid black; width: 70pt">Tanker(Bitumen)</td>
                                </tr>
                                <tr height="35" style="mso-height-source: userset; height: 26.4pt">
                                    <td colspan="3" height="35" class="xl19029830" width="45" style="height: 26.4pt; width: 35pt">CHM</td>
                                    <td colspan="8" class="xl16729830" width="114" style="border-right: 0.5pt solid black; width: 83pt">Chem Carrier IMO I-II</td>
                                    <td colspan="5" class="xl19029830" width="75" style="border-left: none; width: 56pt">HLV</td>
                                    <td colspan="9" class="xl16729830" width="90" style="border-right: 0.5pt solid black; width: 67pt">Heavy Lift Vsl</td>
                                    <td colspan="5" class="xl19029830" width="55" style="border-left: none; width: 40pt">NVL</td>
                                    <td colspan="8" class="xl16729830" width="102" style="border-right: 0.5pt solid black; width: 74pt">Naval Ship</td>
                                    <td colspan="4" class="xl19029830" width="46" style="border-left: none; width: 34pt">R/R</td>
                                    <td colspan="6" class="xl16729830" width="91" style="border-right: 0.5pt solid black; width: 68pt">Ro/Ro Carrier</td>
                                    <td colspan="3" class="xl13129830" width="36" style="border-left: none; width: 27pt">TNC</td>
                                    <td colspan="8" class="xl16729830" width="96" style="border-right: 0.5pt solid black; width: 70pt">Tanker(Crude)</td>
                                </tr>
                                <tr height="35" style="mso-height-source: userset; height: 26.4pt">
                                    <td colspan="3" height="35" class="xl19029830" width="45" style="height: 26.4pt; width: 35pt">CH3</td>
                                    <td colspan="8" class="xl16729830" width="114" style="border-right: 0.5pt solid black; width: 83pt">Chem Carrier IMO III</td>
                                    <td colspan="5" class="xl19029830" width="75" style="border-left: none; width: 56pt">LSH</td>
                                    <td colspan="9" class="xl16729830" width="90" style="border-right: 0.5pt solid black; width: 67pt">Lash</td>
                                    <td colspan="5" class="xl19029830" width="55" style="border-left: none; width: 40pt">RIG</td>
                                    <td colspan="8" class="xl16929830" style="border-right: 0.5pt solid black">Off Shore Oil Rig</td>
                                    <td colspan="4" class="xl19029830" width="46" style="border-left: none; width: 34pt">PRR</td>
                                    <td colspan="6" class="xl16729830" width="91" style="border-right: 0.5pt solid black; width: 68pt">RoRo-Pax</td>
                                    <td colspan="3" class="xl13129830" width="36" style="border-left: none; width: 27pt">TNP</td>
                                    <td colspan="8" class="xl16729830" width="96" style="border-right: 0.5pt solid black; width: 70pt">Tanker(Products)</td>
                                </tr>
                                <tr height="35" style="mso-height-source: userset; height: 26.4pt">
                                    <td colspan="3" height="35" class="xl19029830" width="45" style="height: 26.4pt; width: 35pt">DRG</td>
                                    <td colspan="8" class="xl16729830" width="114" style="border-right: 0.5pt solid black; width: 83pt">Dredgers</td>
                                    <td colspan="5" class="xl19029830" width="75" style="border-left: none; width: 56pt">LIV</td>
                                    <td colspan="9" class="xl16729830" width="90" style="border-right: 0.5pt solid black; width: 67pt">Live Stock</td>
                                    <td colspan="5" class="xl19029830" width="55" style="border-left: none; width: 40pt">OSV</td>
                                    <td colspan="8" class="xl16729830" width="102" style="border-right: 0.5pt solid black; width: 74pt">Offs Shore Supply Vsl</td>
                                    <td colspan="4" class="xl19029830" width="46" style="border-left: none; width: 34pt">SAL</td>
                                    <td colspan="6" class="xl16729830" width="91" style="border-right: 0.5pt solid black; width: 68pt">Sailing Vsl</td>
                                    <td colspan="3" class="xl13129830" width="36" style="border-left: none; width: 27pt">TNS</td>
                                    <td colspan="8" class="xl16729830" width="96" style="border-right: 0.5pt solid black; width: 70pt">Tanker(Storage)</td>
                                </tr>
                                <tr height="35" style="mso-height-source: userset; height: 26.4pt;">
                                    <td colspan="3" height="35" class="xl19029830" width="45" style="height: 26.4pt; width: 35pt">DP</td>
                                    <td colspan="8" class="xl16729830" width="114" style="border-right: 0.5pt solid black; width: 83pt">Dynamic Positioning</td>
                                    <td colspan="5" class="xl19029830" width="75" style="border-left: none; width: 56pt">LNG</td>
                                    <td colspan="9" class="xl16729830" width="90" style="border-right: 0.5pt solid black; width: 67pt">LNG Carrier</td>
                                    <td colspan="5" class="xl19029830" width="55" style="border-left: none; width: 40pt">OBO</td>
                                    <td colspan="8" class="xl16729830" width="102" style="border-right: 0.5pt solid black; width: 74pt">Ore/Bulk/Oil Carrier</td>
                                    <td colspan="4" class="xl19029830" width="46" style="border-left: none; width: 34pt">SRV</td>
                                    <td colspan="6" class="xl16729830" width="91" style="border-right: 0.5pt solid black; width: 68pt">Survey Vessel</td>
                                    <td colspan="3" class="xl13129830" width="36" style="border-left: none; width: 27pt">TNV</td>
                                    <td colspan="8" class="xl16729830" width="96" style="border-right: 0.5pt solid black; width: 70pt; white-space: normal; word-break: break-word;">Tanker (VLCC/ULCC)</td>
                                </tr>
                                <tr height="35" style="mso-height-source: userset; height: 26.4pt">
                                    <td colspan="3" height="35" class="xl19029830" width="45" style="height: 26.4pt; width: 35pt">FSH</td>
                                    <td colspan="8" class="xl16729830" width="114" style="border-right: 0.5pt solid black; width: 83pt">Fishing Vsl</td>
                                    <td colspan="5" class="xl19029830" width="75" style="border-left: none; width: 56pt">LOG</td>
                                    <td colspan="9" class="xl16729830" width="90" style="border-right: 0.5pt solid black; width: 67pt">Log / Timber</td>
                                    <td colspan="5" class="xl19029830" width="55" style="border-left: none; width: 40pt">O/O</td>
                                    <td colspan="8" class="xl16729830" width="102" style="border-right: 0.5pt solid black; width: 74pt">Ore/Oil Carrier</td>
                                    <td colspan="4" class="xl19029830" width="46" style="border-left: none; width: 34pt">SUL</td>
                                    <td colspan="6" class="xl16729830" width="91" style="border-right: 0.5pt solid black; width: 68pt">Self-Unloader</td>
                                    <td colspan="11" class="xl13229830" width="132" style="border-right: 0.5pt solid black; width: 97pt"></td>
                                </tr>
                                <tr height="35" style="mso-height-source: userset; height: 26.4pt">
                                    <td colspan="3" height="35" class="xl19029830" width="45" style="height: 26.4pt; width: 35pt">FSO</td>
                                    <td colspan="8" class="xl16729830" width="114" style="border-right: 0.5pt solid black; width: 83pt">Floating Storage Offldg</td>
                                    <td colspan="5" class="xl19029830" width="75" style="border-left: none; width: 56pt">LPG</td>
                                    <td colspan="9" class="xl16729830" width="90" style="border-right: 0.5pt solid black; width: 67pt">LPG Carrier</td>
                                    <td colspan="5" class="xl19029830" width="55" style="border-left: none; width: 40pt">OTH</td>
                                    <td colspan="8" class="xl16729830" width="102" style="border-right: 0.5pt solid black; width: 74pt">Other</td>
                                    <td colspan="4" class="xl19029830" width="46" style="border-left: none; width: 34pt">TUG</td>
                                    <td colspan="6" class="xl16729830" width="91" style="border-right: 0.5pt solid black; width: 68pt">Tug</td>
                                    <td colspan="11" class="xl13229830" width="132" style="border-right: 0.5pt solid black; width: 97pt"></td>
                                </tr>
                                <tr height="27" style="mso-height-source: userset; height: 20.4pt">
                                    <td colspan="59" height="27" class="xl12829830" style="height: 20.4pt">(2)Engineers to give make/model of engines, e.g. &quot;MAN 14V52/55A&quot; or &quot;SULZER 5RTA58&quot;</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12429830" style="height: 12pt">9. Appraisals</td>
                                </tr>
                                <tr height="16" style="mso-height-source: userset; height: 12pt">
                                    <td colspan="6" height="16" class="xl10129830" style="height: 12pt">Vessel</td>
                                    <td colspan="7" class="xl10129830" style="border-left: none">Rank</td>
                                    <td colspan="6" class="xl18929830" width="93" style="border-left: none; width: 69pt">Questionnaire</td>
                                    <td colspan="8" class="xl10129830" style="border-left: none">Approved</td>
                                    <td colspan="8" class="xl10129830" style="border-left: none">Average Rating</td>
                                    <td colspan="4" class="xl10129830" style="border-left: none">Rehire</td>
                                    <td colspan="5" class="xl10129830" style="border-left: none">Promote</td>
                                    <td colspan="7" class="xl10129830" style="border-left: none">Appraiser</td>
                                    <td colspan="8" class="xl10129830" style="border-left: none">Date Input</td>
                                </tr>
                                @{
                                    var uniqueCurriculumVitae = appraisalData
                                        .Select(item => new
                                        {
                                            VesselName = item["CrewAppraisalVesselName"] ?? "",
                                            Rank = item["CrewAppraisalRank"] ?? "",
                                            Questionnaire = item["CrewAppraisalQuestionnaire"] ?? "",
                                            Approved = item["CrewAppraisalApproved"] != null ? item["CrewAppraisalApproved"].ToString() : "",
                                            AverageRating = item["CrewAppraisalAverageRating"] ?? "",
                                            Rehire = item["CrewAppraisalRehire"] != null ? item["CrewAppraisalRehire"].ToString() : "",
                                            Promote = item["CrewAppraisalPromote"] != null ? item["CrewAppraisalPromote"].ToString() : "",
                                            Appraiser = item["CrewAppraisalAppraiser"] ?? "",
                                            DateInput = ((DateTime?)item["CrewAppraisalDateInput"])?.ToString("dd MMM yyyy") ?? ""
                                        })
                                        .DistinctBy(list => new
                                        {
                                            list.VesselName,
                                            list.Rank,
                                            list.Questionnaire,
                                            list.Approved,
                                            list.AverageRating,
                                            list.Rehire,
                                            list.Promote,
                                            list.Appraiser,
                                            list.DateInput
                                        });
                                    
                                    foreach (var list in uniqueCurriculumVitae)
                                    {
                                        <tr height="15" style="mso-height-source: userset; height: 12pt">
                                            <td colspan="6" height="15" class="xl6529830" style="height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left;">@(list.VesselName)</td>
                                            <td colspan="7" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left">@(list.Rank)</td>
                                            <td colspan="6" class="xl19429830" width="93" style="border-left: none; width: 69pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px; text-align: left;">@(list.Questionnaire)</td>
                                            
                                            @if (list.Approved == "True")
                                            {
                                                <td colspan="8" class="xl6529830" style="border-left: none">Yes</td>
                                            }
                                            else if (list.Approved == "False")
                                            {
                                                <td colspan="8" class="xl6529830" style="border-left: none">No</td>
                                            }
                                            else
                                            {
                                                <td colspan="8" class="xl6529830" style="border-left: none"></td>
                                            }
                                            
                                            <td colspan="8" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(list.AverageRating)</td>
                                            
                                            @if (list.Rehire == "True")
                                            {
                                                <td colspan="4" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Yes</td>
                                            }
                                            else if (list.Rehire == "False")
                                            {
                                                <td colspan="4" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">No</td>
                                            }
                                            else
                                            {
                                                <td colspan="4" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                            }
                                            
                                            @if (list.Promote == "True")
                                            {
                                                <td colspan="5" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Yes</td>
                                            }
                                            else if (list.Promote == "False")
                                            {
                                                <td colspan="5" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">No</td>
                                            }
                                            else
                                            {
                                                <td colspan="5" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                            }
                                            
                                            <td colspan="7" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(list.Appraiser)</td>
                                            <td colspan="8" class="xl6529830" style="border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(list.DateInput)</td>
                                        </tr>
                                    }
                                }                                
                                <tr height="15" style="height: 12pt" >
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="height: 12pt">10. Medical History:</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="53" rowspan="3" height="45" class="xl14029830" width="679" style="border-right: 0.5pt solid black; height: 34.2pt; width: 502pt">
                                        All previous illnesses other than minor afflictions should be started below or updated. If not previously disclosed, the Company is entitled to refuse any reimbursement of medical coasts, claim for treatment or for any other insured
                                        benefits.
                                    </td>
                                    <td colspan="6" class="xl7829830" style="border-right: 0.5pt solid black; border-left: none">Blood Type:</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="6" rowspan="4" height="61" class="xl12729830" style="text-align: center; padding-left: 5px; padding-right: 5px; border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 46.2pt">@medicalHistoryData[0]["CrewBloodType"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="53" height="15" class="xl6829830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                </tr>
                                @{
                                    bool isSignedOff = false;
                                }

                                <tr height="16" style="height: 12pt">
                                    <td colspan="30" height="16" class="xl12129830" style="border-right: 0.5pt solid black; height: 12pt">
                                        (A)<span style="mso-spacerun: yes"></span>Have you ever signed off a ship due to medical reasons?
                                    </td>
                                    <td class="xl7129830" style="border-left: none; padding-left: 0px;">
                                        @if (medicalHistoryData.Any(list => list["MedicalTestHistoryType"].ToString().Equals("Signed Off Due To Medical Reasons")))
                                        {
                                            isSignedOff = true;
                                            <span style="color: black; display: inline-block; line-height: 1">&check;</span>
                                        }
                                        else
                                        {
                                            <span style="color: black; display: inline-block; line-height: 1">&nbsp;</span>
                                        }
                                    </td>
                                    <td colspan="12" class="xl13829830" style="border-right: 0.5pt solid black; border-left: none; padding-left: 0px; ">
                                        <span>Yes</span>
                                    </td>
                                    <td class="xl7129830" style="border-left: none; padding-left: 0px;">
                                        @if (!medicalHistoryData.Any(list => list["MedicalTestHistoryType"].ToString().Equals("Signed Off Due To Medical Reasons")))
                                        {
                                            isSignedOff = false;
                                            <span style="color: black; display: inline-block; line-height: 1">@Html.Raw("&#10004;")</span>
                                        }
                                        else
                                        {
                                            <span style="color: black; display: inline-block; line-height: 1">@Html.Raw("&nbsp;")</span>
                                        }
                                    </td>
                                    <td colspan="12" class="xl13829830" style="border-right: 0.5pt solid black; border-left: none; padding-left: 0px;">
                                        <span>No</span>
                                    </td>
                                    
                                </tr>

                                @if (isSignedOff)
                                {
                                    <tr height="15" style="height: 12pt">
                                        <td colspan="59" height="15" class="xl9229830" style="height: 12pt">
                                            <span style="mso-spacerun: yes"></span>If yes, please provide the following details (if space is insufficient, attach additional sheets):
                                        </td>
                                    </tr>
                                    <tr height="16" style="height: 12pt">
                                        <td colspan="19" height="16" class="xl12529830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Name of Vessel</td>
                                        <td colspan="23" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Date of occurrence</td>
                                        <td colspan="17" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Place of occurrence</td>
                                    </tr>

                                    var uniqueMedicalTestHistory = medicalHistoryData
                                        .Where(item => item["MedicalTestHistoryType"].ToString().Equals("Signed Off Due To Medical Reasons"))
                                        .Select(item => new {
                                            VesselName = item["MedicalTestHistoryVesselName"],
                                            DateOccurence = (DateTime)item["MedicalTestHistoryDateOccurence"],
                                            PlaceOccurence = item["MedicalTestHistoryPlaceOccurence"]
                                        })
                                        .Distinct();

                                    @foreach (var item in uniqueMedicalTestHistory)
                                    {
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="19" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@item.VesselName</td>
                                            <td colspan="23" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@item.DateOccurence.ToString("dd MMM yyyy")</td>
                                            <td colspan="17" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@item.PlaceOccurence</td>
                                        </tr>
                                    }
                                    <tr height="16" style="height: 12pt">
                                        <td colspan="59" height="16" class="xl8729830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Brief description of illness/injury/accident</td>
                                    </tr>
                                    var uniqueMedicalTestHistoryDetail = medicalHistoryData
                                        .Where(list => list["MedicalTestHistoryType"].ToString() == "Signed Off Due To Medical Reasons")
                                        .Select(list => list["MedicalTestHistoryDetail"]?.ToString())
                                        .Distinct();
                                    foreach (var detail in uniqueMedicalTestHistoryDetail)
                                    {
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" rowspan="2" height="30" class="xl9029830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 22.8pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@detail</td>
                                        </tr>
                                    }
                                }
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl8829830" style="height: 12pt; border-top: none;"></td>
                                </tr>
                                @{
                                    bool hasUndergoneOperation = medicalHistoryData.Any(list => list["MedicalTestHistoryType"].ToString().Equals("Medical Operation"));
                                }

                                <tr height="16" style="height: 12pt">
                                    <td colspan="30" height="16" class="xl12129830" style="border-right: 0.5pt solid black; height: 12pt">
                                        (B)<span style="mso-spacerun: yes"></span>Have you undergone any operation in the past?
                                    </td>
                                    <td class="xl7129830" style="border-left: none; padding-left: 0px;">
                                        <span style="color: black; display: inline-block; line-height: 1">
                                            @if (hasUndergoneOperation)
                                            {
                                                <span style="color: black; display: inline-block; line-height: 1">&check;</span>
                                            }
                                            else
                                            {
                                                <span style="color: black; display: inline-block; line-height: 1">&nbsp;</span>
                                            }
                                        </span>
                                    </td>
                                    <td colspan="12" class="xl13829830" style="border-right: 0.5pt solid black; border-left: none; padding-left: 0px;">
                                        <span>Yes</span>
                                    </td>
                                    <td class="xl7129830" style="border-left: none; padding-left: 0px;">
                                        @if (hasUndergoneOperation)
                                        {
                                            <span style="color: black; display: inline-block; line-height: 1">&nbsp;</span>
                                        }
                                        else
                                        {
                                            <span style="color: black; display: inline-block; line-height: 1">&check;</span>
                                        }
                                    </td>
                                    <td colspan="12" class="xl13829830" style="border-right: 0pt solid black; border-left: none; padding-left: 0px;">
                                        <span>No</span>
                                    </td>
                                </tr>

                                @if (hasUndergoneOperation)
                                {
                                    <tr height="15" style="height: 12pt">
                                        <td colspan="59" height="15" class="xl9229830" style="height: 12pt">
                                            <span style="mso-spacerun: yes"></span>If yes, please provide the following details:
                                        </td>
                                    </tr>
                                    <tr height="16" style="height: 12pt">
                                        <td colspan="20" height="16" class="xl12529830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Details of Operation</td>
                                        <td colspan="15" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Date</td>
                                        <td colspan="15" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Period of Disability</td>
                                        <td colspan="9" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Present Condition</td>
                                    </tr>

                                    var uniqueOperations = medicalHistoryData
                                        .Where(list => list["MedicalTestHistoryType"].ToString().Equals("Medical Operation"))
                                        .Select(list => new
                                        {
                                            Detail = list["MedicalTestHistoryDetail"]?.ToString(),
                                            Date = ((DateTime)list["MedicalTestHistoryDateOccurence"]).ToString("dd MMM yyyy"),
                                            PeriodOfDisability = list["MedicalTestHistoryPeriodOfDisability"]?.ToString(),
                                            PresentCondition = list["MedicalTestHistoryPresentCondition"]?.ToString()
                                        })
                                        .Distinct();

                                    foreach (var operation in uniqueOperations)
                                    {
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="20" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@operation.Detail</td>
                                            <td colspan="15" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@operation.Date</td>
                                            <td colspan="15" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@operation.PeriodOfDisability</td>
                                            <td colspan="9" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@operation.PresentCondition</td>
                                        </tr>
                                    }
                                }
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt; border-top: none;"></td>
                                </tr>
                                @{
                                    DateTime currentDate = DateTime.Now;
                                    DateTime startDate = currentDate.AddMonths(-12);
                                    var medicalTests = medicalHistoryData
                                        .Where(list => list["MedicalTestHistoryType"].ToString() == "Has Illness Or Accident Consulted To Doctor" &&
                                                    DateTime.Parse(list["MedicalTestHistoryDateOccurence"].ToString()) >= startDate &&
                                                    DateTime.Parse(list["MedicalTestHistoryDateOccurence"].ToString()) <= currentDate)
                                        .ToList();

                                    var healthProblems = medicalHistoryData
                                        .Where(list => list["MedicalTestHistoryType"].ToString() == "Health Or Disability Problem")
                                        .Select(list => list["MedicalTestHistoryDetail"]?.ToString())
                                        .Distinct();
                                }
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="border-right: 0pt solid black; height: 12pt">
                                        (C)<span style="mso-spacerun: yes"></span>For what illnesses or accidents have you consulted a doctor during the last 12 months?
                                    </td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="19" height="16" class="xl12529830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Details of Illness / Accident</td>
                                    <td colspan="23" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Date</td>
                                    <td colspan="17" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">Therapy / Treatment</td>
                                </tr>
                                @if (medicalTests.Any())
                                {
                                    @foreach (var item in medicalTests)
                                    {
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="19" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@item["MedicalTestHistoryDetail"]</td>
                                            <td colspan="23" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@(((DateTime)item["MedicalTestHistoryDateOccurence"]).ToString("dd MMM yyyy"))</td>
                                            <td colspan="17" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@item["MedicalTestHistoryTreatment"]</td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr height="15" style="height: 12pt">
                                        <td colspan="19" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                        <td colspan="23" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                        <td colspan="17" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;"></td>
                                    </tr>
                                }
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt; border-top: 0pt;"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12429830" style="height: 12pt">(D)<span style="mso-spacerun: yes"> </span>Please give details of any health or disability problem</td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12529830" style="border-right: 0.5pt solid black; height: 12pt">Details</td>
                                </tr>
                                @foreach (var problem in healthProblems)
                                {
                                    <tr height="15" style="height: 12pt">
                                        <td colspan="59" height="15" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word; padding-left: 5px; padding-right: 3px;">@problem</td>
                                    </tr>
                                }
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                </tr>

                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="height: 12pt">
                                        7.<span style="mso-spacerun: yes"> </span><font class="font1129830"><span style="mso-spacerun: yes"></span>General</font>
                                    </td>
                                </tr>
                                
                                @{
                                    var deniedCountries = generalData
                                        .Where(list => list["ForeignVisaHasBeenDenied"].ToString().Equals("True"))
                                        .Select(list => new {
                                            Country = list["ForeignVisaHasBeenDeniedCountry"].ToString(),
                                            Reason = list["ForeignVisaDeniedReason"].ToString()
                                        })
                                        .Distinct();

                                    bool hasDeniedForeignVisa = deniedCountries.Any();

                                    <tr height="16" style="height: 12pt">
                                        <td colspan="30" height="16" class="xl12129830" style="border-right: 0.5pt solid black; height: 12pt">
                                            (A)<span style="mso-spacerun: yes"></span> Have you ever been denied foreign visa?
                                        </td>
                                        <td class="xl7129830" style="border-left: none; padding-left: 0px;">
                                            <span style="color: black; display: inline-block; line-height: 1">
                                                @if(hasDeniedForeignVisa) {
                                                    <span style="color: black; display: inline-block; line-height: 1">&check;</span>
                                                }
                                                else {
                                                    <span style="color: black; display: inline-block; line-height: 1">&nbsp;</span>
                                                }
                                            </span>
                                        </td>
                                        <td colspan="12" class="xl13829830" style="border-right: 0.5pt solid black; border-left: none; padding-left: 0px;">
                                            <span>Yes</span>
                                        </td>
                                        <td class="xl7129830" style="border-left: none; padding-left: 0px;">
                                            @if(hasDeniedForeignVisa) {
                                                <span style="color: black; display: inline-block; line-height: 1">&nbsp;</span>
                                            }
                                            else {
                                                <span style="color: black; display: inline-block; line-height: 1">&check;</span>
                                            }
                                        </td>
                                        <td colspan="12" class="xl13829830" style="border-right: 0pt solid black; border-left: none; padding-left: 0px;">
                                            <span>No</span>
                                        </td>
                                    </tr>
                                    @if(hasDeniedForeignVisa) {
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl9229830" style="height: 12pt">
                                                <span style="mso-spacerun: yes"></span>If yes, state which country and reason:
                                            </td>
                                        </tr>
                                        @foreach (var deniedCountry in deniedCountries) {
                                            <tr height="16" style="height: 12pt">
                                                <td colspan="59" height="16" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word;">
                                                    @deniedCountry.Country - @deniedCountry.Reason
                                                </td>
                                            </tr>
                                        }
                                    }
                                    else {
                                        <tr height="15" style="height: 12pt; border-bottom: 0pt">
                                            <td colspan="59" height="15" class="xl9229830" style="height: 12pt; border-bottom: 0pt"></td>
                                        </tr>
                                    }
                                }
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt; border-top: 0pt"></td>
                                </tr>
                                @{
                                    var courtOfEnquiryOrAccidentDetails = generalData
                                        .Where(list => list["HasMaritimeAccidentOrCourtOfEnquiry"].ToString().Equals("True"))
                                        .Select(list => list["HasMaritimeAccidentOrCourtOfEnquiryDetails"].ToString())
                                        .Distinct();

                                    bool hasCourtOfEnquiryOrMaritimeAccident = courtOfEnquiryOrAccidentDetails.Any();

                                    <tr height="16" style="height: 12pt">
                                        <td colspan="43" height="16" class="xl12129830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word;">
                                            (B)<span style="mso-spacerun: yes"> </span>Have you been the subject of a court of enquiry or involved in a maritime accident?
                                        </td>
                                        <td class="xl7129830" style="border-left: none; padding-left: 0px;">
                                            <span style="color: black; display: inline-block; line-height: 1">
                                                @if(hasCourtOfEnquiryOrMaritimeAccident) {
                                                    <span style="color: black; display: inline-block; line-height: 1">&check;</span>
                                                }
                                                else {
                                                    <span style="color: black; display: inline-block; line-height: 1">&nbsp;</span>
                                                }
                                            </span>
                                        </td>
                                        <td colspan="6" class="xl13829830" style="border-right: 0.5pt solid black; border-left: none; padding-left: 0px;">
                                            <span>Yes</span>
                                        </td>
                                        <td class="xl7129830" style="border-left: none; padding-left: 0px;">
                                            @if(hasCourtOfEnquiryOrMaritimeAccident) {
                                                <span style="color: black; display: inline-block; line-height: 1">&nbsp;</span>
                                            }
                                            else {
                                                <span style="color: black; display: inline-block; line-height: 1">&check;</span>
                                            }
                                        </td>
                                        <td colspan="6" class="xl13829830" style="border-right: 0pt solid black; border-left: none; padding-left: 0px;">
                                            <span>No</span>
                                        </td>
                                    </tr>

                                    @if(hasCourtOfEnquiryOrMaritimeAccident) {
                                        <tr height="15" style="height: 12pt">
                                            <td colspan="59" height="15" class="xl9229830" style="height: 12pt">
                                                <span style="mso-spacerun: yes"></span>If yes, provide details:
                                            </td>
                                        </tr>
                                        @foreach (var detail in courtOfEnquiryOrAccidentDetails) {
                                            <tr height="16" style="height: 12pt">
                                                <td colspan="59" height="16" class="xl11229830" style="border-right: 0.5pt solid black; height: 12pt; white-space: normal; word-break: break-word;">
                                                    @detail
                                                </td>
                                            </tr>
                                        }
                                    }
                                    else {
                                        <tr height="15" style="height: 12pt; border-bottom: 0pt">
                                            <td colspan="59" height="15" class="xl9229830" style="height: 12pt; border-bottom: 0pt"></td>
                                        </tr>
                                    }

                                }
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt; border-top: 0pt"></td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="59" height="16" class="xl12129830" style="height: 12pt">(C)<span style="mso-spacerun: yes"> </span>Give details below of two recent employers who we may contact for references:</td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="18" height="16" class="xl9229830" style="border-right: 0.5pt solid black; height: 12pt"></td>
                                    <td colspan="22" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none">Reference 1</td>
                                    <td colspan="19" class="xl12529830" style="border-right: 0.5pt solid black; border-left: none">Reference 2</td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="18" height="16" class="xl12529830" style="border-right: 0.5pt solid black; height: 12pt">Name of Company</td>
                                    <td colspan="22" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none">@generalData[0]["Reference1CompanyName"]</td>
                                    <td colspan="19" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none">@generalData[0]["Reference2CompanyName"]</td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="18" height="16" class="xl12529830" style="border-right: 0.5pt solid black; height: 12pt">Name of person to contact</td>
                                    <td colspan="22" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none">@generalData[0]["Reference1ContactPersonName"]</td>
                                    <td colspan="19" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none">@generalData[0]["Reference2ContactPersonName"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="18" rowspan="3" height="45" class="xl8729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; height: 34.2pt">Address</td>
                                    <td colspan="22" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word;">@generalData[0]["Reference1CompanyAddress"]</td>
                                    <td colspan="19" rowspan="3" class="xl12729830" style="border-right: 0.5pt solid black; border-bottom: 0.5pt solid black; white-space: normal; word-break: break-word;">@generalData[0]["Reference2CompanyAddress"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="18" height="16" class="xl12529830" style="border-right: 0.5pt solid black; height: 12pt">Country</td>
                                    <td colspan="22" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none">@generalData[0]["Reference1CompanyCountry"]</td>
                                    <td colspan="19" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none">@generalData[0]["Reference2CompanyCountry"]</td>
                                </tr>
                                <tr height="16" style="height: 12pt">
                                    <td colspan="18" height="16" class="xl12529830" style="border-right: 0.5pt solid black; height: 12pt">Telephone</td>
                                    <td colspan="22" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none">@generalData[0]["Reference1CompanyTelephone"]</td>
                                    <td colspan="19" class="xl11229830" style="border-right: 0.5pt solid black; border-left: none">@generalData[0]["Reference2CompanyTelephone"]</td>
                                </tr>
                                <tr height="15" style="height: 12pt" >
                                    <td colspan="59" height="15" class="xl12829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" rowspan="10" height="150" class="xl17129830" width="750" style="height: 114pt; width: 554pt">
                                        I hereby declare that the above, Including Medical History, is true. <br />
                                        I further consent to the holding and processing by you and any of your direct or indirect parent or subsidiary or associated or affiliated companies and your principals of personal data <br />
                                        about me (including where appropriate data concerning racial or ethnic origin, religious beliefs, membership of a trade union, physical or mental health or condition, commission or <br />
                                        alleged commission of an offence and the proceedings and this outcome of any proceedings relating thereto) for all purposes related to my application for employment on board vessels <br />
                                        managed by MSI, owned or operated by third parties for whom MSI is engaged to provide crew. <br />
                                        I understand that this data will be stored in your databases in relation to my actual or potential employment by or through MSI. Further, I confirm that the above may involve the transfer or my personal data within MSI or to third parties
                                        worldwide.
                                    </td>
                                </tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt"></tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="4" height="15" class="xl13729830" style="height: 12pt">Place:</td>
                                    <td colspan="10" class="xl6829830">..</td>
                                    <td colspan="4" class="xl13729830">Date:</td>
                                    <td colspan="14" class="xl6829830"></td>
                                    <td colspan="6" class="xl13729830">Signature:</td>
                                    <td colspan="21" class="xl6829830">..</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl13629830" style="height: 12pt">For Office Use:</td>
                                </tr>
                                <tr height="15" style="height: 12pt">
                                    <td colspan="59" height="15" class="xl6829830" style="height: 12pt"></td>
                                </tr>

                                <![if supportMisalignedColumns]>
                                <tr height="0" style="display: none">
                                    <td width="14" style="width: 11pt"></td>
                                    <td width="17" style="width: 13pt"></td>
                                    <td width="14" style="width: 11pt"></td>
                                    <td width="19" style="width: 14pt"></td>
                                    <td width="14" style="width: 10pt"></td>
                                    <td width="14" style="width: 10pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="19" style="width: 14pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="15" style="width: 11pt"></td>
                                    <td width="14" style="width: 11pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="21" style="width: 16pt"></td>
                                    <td width="18" style="width: 13pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="14" style="width: 10pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="18" style="width: 14pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="2" style="width: 2pt"></td>
                                    <td width="1" style="width: 1pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="15" style="width: 11pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="18" style="width: 13pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="14" style="width: 10pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="18" style="width: 13pt"></td>
                                    <td width="1" style="width: 1pt"></td>
                                    <td width="17" style="width: 13pt"></td>
                                    <td width="10" style="width: 7pt"></td>
                                    <td width="14" style="width: 11pt"></td>
                                    <td width="17" style="width: 13pt"></td>
                                    <td width="15" style="width: 11pt"></td>
                                    <td width="19" style="width: 14pt"></td>
                                    <td width="15" style="width: 11pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="14" style="width: 11pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="14" style="width: 10pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="14" style="width: 10pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="14" style="width: 10pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="11" style="width: 8pt"></td>
                                    <td width="10" style="width: 8pt"></td>
                                </tr>
                                <![endif]>
                            </div>
                        </td>
                    </tr>
                </tbody>
                
                <tfoot>
                    <div class="empty-footer"></div>
                </tfoot>
            </table>

            <div class="header">
                <div class="row">
                    <div class="col-sm-3">
                        <img src="https://pertamina-pis.com/images/Logo_Pertamina_PIS.svg" alt="PIS_LOGO" style="width: 100%; height: max-height;">
                    </div>
                    <div class="col-sm-6">
                        <h6 style="font-weight: bold;">PT PERTAMINA INTERNATIONAL SHIPPING</h6>
                        <h6 style="font-weight: bold;">CURRICULUM VITAE</h6>
                    </div>
                    <div class="col-sm-3">
                        <p>Form 560</p>
                    </div>
                </div>
            </div>
            
            @*
            <div class="footer">
                <div class="row col-sm-12">
                    <div class="col-sm-2">2023</div>
                    <div class="col-sm-8">PT Pertamina International Shipping</div>
                    <div class="col-sm-2 page-counter text-counter"></div>
                </div>
            </div>
            *@

        </div>

        <div class="d-flex justify-content-end align-items-center py-4">
            <button id="print-data" onClick="printData()" name="print-data" type="button" class="btn" style="background: #afc535; color: white;">
                Print Data
            </button>
        </div>

        <script>
            var dateOfBirth = '@(((DateTime?)@personalData[0]["DateOfBirth"])?.ToString("dd/MMM/yyyy"))';
            var availableFrom = '@(((DateTime?)@personalData[0]["AvailableFrom"])?.ToString("dd/MMM/yyyy"))';
            var availableUntil = '@(((DateTime?)@personalData[0]["AvailableUntil"])?.ToString("dd/MMM/yyyy"))';

            var partsDOB = dateOfBirth.split('/');
            var partsAvailableFrom = availableFrom.split('/');
            var partsAvailableUntil = availableUntil.split('/');

            var ddDOB = partsDOB[0] || '';
            var mmDOB = partsDOB[1] || '';
            var yyyyDOB = partsDOB[2] || '';

            var ddAvailableFrom = partsAvailableFrom[0] || '';
            var mmAvailableFrom = partsAvailableFrom[1] || '';
            var yyyyAvailableFrom = partsAvailableFrom[2] || '';

            var ddAvailableUntil = partsAvailableUntil[0] || '';
            var mmAvailableUntil = partsAvailableUntil[1] || '';
            var yyyyAvailableUntil = partsAvailableUntil[2] || '';

            document.getElementsByClassName('xl6529830')[0].innerText = ddDOB;
            document.getElementsByClassName('xl6529830')[1].innerText = mmDOB;
            document.getElementsByClassName('xl6529830')[2].innerText = yyyyDOB;

            document.getElementsByClassName('xl7829830')[1].innerText = ddAvailableFrom;
            document.getElementsByClassName('xl7829830')[2].innerText = mmAvailableFrom;
            document.getElementsByClassName('xl7829830')[3].innerText = yyyyAvailableFrom;

            document.getElementsByClassName('xl9429830')[1].innerText = ddAvailableUntil;
            document.getElementsByClassName('xl9429830')[2].innerText = mmAvailableUntil;
            document.getElementsByClassName('xl9429830')[3].innerText = yyyyAvailableUntil;
        </script>


        <script>
            function addHeaderFooterForPrint() {
                var headerElement = document.getElementById("header560");
                var footerElement = document.getElementById("footer560");
                
                var headerHTML = headerElement.innerHTML;
                var footerHTML = footerElement.innerHTML;

                var contentDiv = document.getElementById("content");

                contentDiv.insertAdjacentHTML('beforebegin', headerHTML);
                contentDiv.insertAdjacentHTML('afterend', footerHTML);
            }

            function printData() {
                window.print();
            };
            window.matchMedia('print').addListener(function(event) {
                if (event.matches) {
                    // print dialog opened
                    document.getElementById('print-data').style.display = 'none';
                } else {
                    // print dialog closed
                    document.getElementById('print-data').style.display = 'block';
                }
            });

            window.onbeforeprint = function() {
                addHeaderFooterForPrint();
            };
        </script>
    }  
    else 
    {
        <div>
            <h1>Data not found!</h1>
        </div>
    }
}
@* END_CUSTOM_TEMPLATE *@
@Html.Raw(GetDebugMessage())
